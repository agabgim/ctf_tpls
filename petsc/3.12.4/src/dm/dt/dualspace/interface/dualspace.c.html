<center><a href="dualspace.c">Actual source code: dualspace.c</a></center><br>

<html>
<head> <link rel="canonical" href="http://www.mcs.anl.gov/petsc/petsc-current/src/dm/dt/dualspace/interface/dualspace.c.html" />
<title></title>
<meta name="generator" content="c2html 0.9.4">
<meta name="date" content="2020-02-04T17:08:39+00:00">
</head>

<body bgcolor="#FFFFFF">
   <div id="version" align=right><b>petsc-3.12.4 2020-02-04</b></div>
   <div id="bugreport" align=right><a href="mailto:petsc-maint@mcs.anl.gov?subject=Typo or Error in Documentation &body=Please describe the typo or error in the documentation: petsc-3.12.4 v3.12.4 src/dm/dt/dualspace/interface/dualspace.c.html "><small>Report Typos and Errors</small></a></div>
<pre width="80">
<a name="line1">  1: </a> #include <A href="../../../../../include/petsc/private/petscfeimpl.h.html">&lt;petsc/private/petscfeimpl.h&gt;</A>
<a name="line2">  2: </a> #include <A href="../../../../../include/petscdmplex.h.html">&lt;petscdmplex.h&gt;</A>

<a name="line4">  4: </a><a href="../../../../../docs/manualpages/Sys/PetscClassId.html#PetscClassId">PetscClassId</a> PETSCDUALSPACE_CLASSID = 0;

<a name="line6">  6: </a><a href="../../../../../docs/manualpages/Sys/PetscFunctionList.html#PetscFunctionList">PetscFunctionList</a> PetscDualSpaceList              = NULL;
<a name="line7">  7: </a><a href="../../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a>         PetscDualSpaceRegisterAllCalled = <a href="../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</a>;

<a name="line9">  9: </a>const char *const PetscDualSpaceReferenceCells[] = {<font color="#666666">"SIMPLEX"</font>, <font color="#666666">"TENSOR"</font>, <font color="#666666">"<a href="../../../../../docs/manualpages/FE/PetscDualSpaceReferenceCell.html#PetscDualSpaceReferenceCell">PetscDualSpaceReferenceCell</a>"</font>, <font color="#666666">"PETSCDUALSPACE_REFCELL_"</font>,0};

<a name="line11"> 11: </a><font color="#B22222">/*</font>
<a name="line12"> 12: </a><font color="#B22222">  PetscDualSpaceLatticePointLexicographic_Internal - Returns all tuples of size 'len' with nonnegative integers that sum up to at most 'max'.</font>
<a name="line13"> 13: </a><font color="#B22222">                                                     Ordering is lexicographic with lowest index as least significant in ordering.</font>
<a name="line14"> 14: </a><font color="#B22222">                                                     e.g. for len == 2 and max == 2, this will return, in order, {0,0}, {1,0}, {2,0}, {0,1}, {1,1}, {2,0}.</font>

<a name="line16"> 16: </a><font color="#B22222">  Input Parameters:</font>
<a name="line17"> 17: </a><font color="#B22222">+ len - The length of the tuple</font>
<a name="line18"> 18: </a><font color="#B22222">. max - The maximum sum</font>
<a name="line19"> 19: </a><font color="#B22222">- tup - A tuple of length len+1: tup[len] &gt; 0 indicates a stopping condition</font>

<a name="line21"> 21: </a><font color="#B22222">  Output Parameter:</font>
<a name="line22"> 22: </a><font color="#B22222">. tup - A tuple of len integers whos sum is at most 'max'</font>

<a name="line24"> 24: </a><font color="#B22222">  Level: developer</font>

<a name="line26"> 26: </a><font color="#B22222">.seealso: PetscDualSpaceTensorPointLexicographic_Internal()</font>
<a name="line27"> 27: </a><font color="#B22222">*/</font>
<a name="line28"> 28: </a><strong><font color="#4169E1"><a name="PetscDualSpaceLatticePointLexicographic_Internal"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> PetscDualSpaceLatticePointLexicographic_Internal(<a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> len, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> max, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> tup[])</font></strong>
<a name="line29"> 29: </a>{
<a name="line31"> 31: </a>  <font color="#4169E1">while</font> (len--) {
<a name="line32"> 32: </a>    max -= tup[len];
<a name="line33"> 33: </a>    <font color="#4169E1">if</font> (!max) {
<a name="line34"> 34: </a>      tup[len] = 0;
<a name="line35"> 35: </a>      <font color="#4169E1">break</font>;
<a name="line36"> 36: </a>    }
<a name="line37"> 37: </a>  }
<a name="line38"> 38: </a>  tup[++len]++;
<a name="line39"> 39: </a>  <font color="#4169E1">return</font>(0);
<a name="line40"> 40: </a>}

<a name="line42"> 42: </a><font color="#B22222">/*</font>
<a name="line43"> 43: </a><font color="#B22222">  PetscDualSpaceTensorPointLexicographic_Internal - Returns all tuples of size 'len' with nonnegative integers that are all less than or equal to 'max'.</font>
<a name="line44"> 44: </a><font color="#B22222">                                                    Ordering is lexicographic with lowest index as least significant in ordering.</font>
<a name="line45"> 45: </a><font color="#B22222">                                                    e.g. for len == 2 and max == 2, this will return, in order, {0,0}, {1,0}, {2,0}, {0,1}, {1,1}, {2,1}, {0,2}, {1,2}, {2,2}.</font>

<a name="line47"> 47: </a><font color="#B22222">  Input Parameters:</font>
<a name="line48"> 48: </a><font color="#B22222">+ len - The length of the tuple</font>
<a name="line49"> 49: </a><font color="#B22222">. max - The maximum value</font>
<a name="line50"> 50: </a><font color="#B22222">- tup - A tuple of length len+1: tup[len] &gt; 0 indicates a stopping condition</font>

<a name="line52"> 52: </a><font color="#B22222">  Output Parameter:</font>
<a name="line53"> 53: </a><font color="#B22222">. tup - A tuple of len integers whos sum is at most 'max'</font>

<a name="line55"> 55: </a><font color="#B22222">  Level: developer</font>

<a name="line57"> 57: </a><font color="#B22222">.seealso: PetscDualSpaceLatticePointLexicographic_Internal()</font>
<a name="line58"> 58: </a><font color="#B22222">*/</font>
<a name="line59"> 59: </a><strong><font color="#4169E1"><a name="PetscDualSpaceTensorPointLexicographic_Internal"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> PetscDualSpaceTensorPointLexicographic_Internal(<a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> len, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> max, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> tup[])</font></strong>
<a name="line60"> 60: </a>{
<a name="line61"> 61: </a>  <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>       i;

<a name="line64"> 64: </a>  <font color="#4169E1">for</font> (i = 0; i &lt; len; i++) {
<a name="line65"> 65: </a>    <font color="#4169E1">if</font> (tup[i] &lt; max) {
<a name="line66"> 66: </a>      <font color="#4169E1">break</font>;
<a name="line67"> 67: </a>    } <font color="#4169E1">else</font> {
<a name="line68"> 68: </a>      tup[i] = 0;
<a name="line69"> 69: </a>    }
<a name="line70"> 70: </a>  }
<a name="line71"> 71: </a>  tup[i]++;
<a name="line72"> 72: </a>  <font color="#4169E1">return</font>(0);
<a name="line73"> 73: </a>}

<a name="line75"> 75: </a><font color="#B22222">/*@C</font>
<a name="line76"> 76: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceRegister.html#PetscDualSpaceRegister">PetscDualSpaceRegister</a> - Adds a new <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> implementation</font>

<a name="line78"> 78: </a><font color="#B22222">  Not Collective</font>

<a name="line80"> 80: </a><font color="#B22222">  Input Parameters:</font>
<a name="line81"> 81: </a><font color="#B22222">+ name        - The name of a new user-defined creation routine</font>
<a name="line82"> 82: </a><font color="#B22222">- create_func - The creation routine itself</font>

<a name="line84"> 84: </a><font color="#B22222">  Notes:</font>
<a name="line85"> 85: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceRegister.html#PetscDualSpaceRegister">PetscDualSpaceRegister</a>() may be called multiple times to add several user-defined PetscDualSpaces</font>

<a name="line87"> 87: </a><font color="#B22222">  Sample usage:</font>
<a name="line88"> 88: </a><font color="#B22222">.vb</font>
<a name="line89"> 89: </a><font color="#B22222">    <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceRegister.html#PetscDualSpaceRegister">PetscDualSpaceRegister</a>("my_space", MyPetscDualSpaceCreate);</font>
<a name="line90"> 90: </a><font color="#B22222">.ve</font>

<a name="line92"> 92: </a><font color="#B22222">  Then, your <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> type can be chosen with the procedural interface via</font>
<a name="line93"> 93: </a><font color="#B22222">.vb</font>
<a name="line94"> 94: </a><font color="#B22222">    <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>(<a href="../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</a>, <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> *);</font>
<a name="line95"> 95: </a><font color="#B22222">    <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetType.html#PetscDualSpaceSetType">PetscDualSpaceSetType</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a>, "my_dual_space");</font>
<a name="line96"> 96: </a><font color="#B22222">.ve</font>
<a name="line97"> 97: </a><font color="#B22222">   or at runtime via the option</font>
<a name="line98"> 98: </a><font color="#B22222">.vb</font>
<a name="line99"> 99: </a><font color="#B22222">    -petscdualspace_type my_dual_space</font>
<a name="line100">100: </a><font color="#B22222">.ve</font>

<a name="line102">102: </a><font color="#B22222">  Level: advanced</font>

<a name="line104">104: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DM/PetscDualSpaceRegisterAll.html#PetscDualSpaceRegisterAll">PetscDualSpaceRegisterAll</a>(), PetscDualSpaceRegisterDestroy()</font>

<a name="line106">106: </a><font color="#B22222">@*/</font>
<a name="line107">107: </a><strong><font color="#4169E1"><a name="PetscDualSpaceRegister"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceRegister.html#PetscDualSpaceRegister">PetscDualSpaceRegister</a>(const char sname[], <a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> (*function)(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a>))</font></strong>
<a name="line108">108: </a>{

<a name="line112">112: </a>  <a href="../../../../../docs/manualpages/Sys/PetscFunctionListAdd.html#PetscFunctionListAdd">PetscFunctionListAdd</a>(&amp;PetscDualSpaceList, sname, function);
<a name="line113">113: </a>  <font color="#4169E1">return</font>(0);
<a name="line114">114: </a>}

<a name="line116">116: </a><font color="#B22222">/*@C</font>
<a name="line117">117: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetType.html#PetscDualSpaceSetType">PetscDualSpaceSetType</a> - Builds a particular <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>

<a name="line119">119: </a><font color="#B22222">  Collective on sp</font>

<a name="line121">121: </a><font color="#B22222">  Input Parameters:</font>
<a name="line122">122: </a><font color="#B22222">+ sp   - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> object</font>
<a name="line123">123: </a><font color="#B22222">- name - The kind of space</font>

<a name="line125">125: </a><font color="#B22222">  Options Database Key:</font>
<a name="line126">126: </a><font color="#B22222">. -petscdualspace_type &lt;type&gt; - Sets the <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> type; use -help for a list of available types</font>

<a name="line128">128: </a><font color="#B22222">  Level: intermediate</font>

<a name="line130">130: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetType.html#PetscDualSpaceGetType">PetscDualSpaceGetType</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>()</font>
<a name="line131">131: </a><font color="#B22222">@*/</font>
<a name="line132">132: </a><strong><font color="#4169E1"><a name="PetscDualSpaceSetType"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetType.html#PetscDualSpaceSetType">PetscDualSpaceSetType</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, <a href="../../../../../docs/manualpages/FE/PetscDualSpaceType.html#PetscDualSpaceType">PetscDualSpaceType</a> name)</font></strong>
<a name="line133">133: </a>{
<a name="line134">134: </a>  <a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> (*r)(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a>);
<a name="line135">135: </a>  <a href="../../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a>      match;

<a name="line140">140: </a>  <a href="../../../../../docs/manualpages/Sys/PetscObjectTypeCompare.html#PetscObjectTypeCompare">PetscObjectTypeCompare</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) sp, name, &amp;match);
<a name="line141">141: </a>  <font color="#4169E1">if</font> (match) <font color="#4169E1">return</font>(0);

<a name="line143">143: </a>  <font color="#4169E1">if</font> (!PetscDualSpaceRegisterAllCalled) {<a href="../../../../../docs/manualpages/DM/PetscDualSpaceRegisterAll.html#PetscDualSpaceRegisterAll">PetscDualSpaceRegisterAll</a>();}
<a name="line144">144: </a>  <a href="../../../../../docs/manualpages/Sys/PetscFunctionListFind.html#PetscFunctionListFind">PetscFunctionListFind</a>(PetscDualSpaceList, name, &amp;r);
<a name="line145">145: </a>  <font color="#4169E1">if</font> (!r) <a href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) sp), PETSC_ERR_ARG_UNKNOWN_TYPE, <font color="#666666">"Unknown <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> type: %s"</font>, name);

<a name="line147">147: </a>  <font color="#4169E1">if</font> (sp-&gt;ops-&gt;destroy) {
<a name="line148">148: </a>    (*sp-&gt;ops-&gt;destroy)(sp);
<a name="line149">149: </a>    sp-&gt;ops-&gt;destroy = NULL;
<a name="line150">150: </a>  }
<a name="line151">151: </a>  (*r)(sp);
<a name="line152">152: </a>  PetscObjectChangeTypeName((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) sp, name);
<a name="line153">153: </a>  <font color="#4169E1">return</font>(0);
<a name="line154">154: </a>}

<a name="line156">156: </a><font color="#B22222">/*@C</font>
<a name="line157">157: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetType.html#PetscDualSpaceGetType">PetscDualSpaceGetType</a> - Gets the <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> type name (as a string) from the object.</font>

<a name="line159">159: </a><font color="#B22222">  Not Collective</font>

<a name="line161">161: </a><font color="#B22222">  Input Parameter:</font>
<a name="line162">162: </a><font color="#B22222">. sp  - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>

<a name="line164">164: </a><font color="#B22222">  Output Parameter:</font>
<a name="line165">165: </a><font color="#B22222">. name - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> type name</font>

<a name="line167">167: </a><font color="#B22222">  Level: intermediate</font>

<a name="line169">169: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetType.html#PetscDualSpaceSetType">PetscDualSpaceSetType</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>()</font>
<a name="line170">170: </a><font color="#B22222">@*/</font>
<a name="line171">171: </a><strong><font color="#4169E1"><a name="PetscDualSpaceGetType"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetType.html#PetscDualSpaceGetType">PetscDualSpaceGetType</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, <a href="../../../../../docs/manualpages/FE/PetscDualSpaceType.html#PetscDualSpaceType">PetscDualSpaceType</a> *name)</font></strong>
<a name="line172">172: </a>{

<a name="line178">178: </a>  <font color="#4169E1">if</font> (!PetscDualSpaceRegisterAllCalled) {
<a name="line179">179: </a>    <a href="../../../../../docs/manualpages/DM/PetscDualSpaceRegisterAll.html#PetscDualSpaceRegisterAll">PetscDualSpaceRegisterAll</a>();
<a name="line180">180: </a>  }
<a name="line181">181: </a>  *name = ((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) sp)-&gt;type_name;
<a name="line182">182: </a>  <font color="#4169E1">return</font>(0);
<a name="line183">183: </a>}

<a name="line185">185: </a><strong><font color="#4169E1"><a name="PetscDualSpaceView_ASCII"></a>static <a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> PetscDualSpaceView_ASCII(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, <a href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</a> v)</font></strong>
<a name="line186">186: </a>{
<a name="line187">187: </a>  <a href="../../../../../docs/manualpages/Viewer/PetscViewerFormat.html#PetscViewerFormat">PetscViewerFormat</a> format;
<a name="line188">188: </a>  <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>          pdim, f;
<a name="line189">189: </a>  <a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a>    ierr;

<a name="line192">192: </a>  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetDimension.html#PetscDualSpaceGetDimension">PetscDualSpaceGetDimension</a>(sp, &amp;pdim);
<a name="line193">193: </a>  <a href="../../../../../docs/manualpages/Sys/PetscObjectPrintClassNamePrefixType.html#PetscObjectPrintClassNamePrefixType">PetscObjectPrintClassNamePrefixType</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) sp, v);
<a name="line194">194: </a>  <a href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPushTab.html#PetscViewerASCIIPushTab">PetscViewerASCIIPushTab</a>(v);
<a name="line195">195: </a>  <a href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(v, <font color="#666666">"Dual space with %D components, size %D\n"</font>, sp-&gt;Nc, pdim);
<a name="line196">196: </a>  <font color="#4169E1">if</font> (sp-&gt;ops-&gt;view) {(*sp-&gt;ops-&gt;view)(sp, v);}
<a name="line197">197: </a>  PetscViewerGetFormat(v, &amp;format);
<a name="line198">198: </a>  <font color="#4169E1">if</font> (format == <a href="../../../../../docs/manualpages/Viewer/PetscViewerFormat.html#PetscViewerFormat">PETSC_VIEWER_ASCII_INFO_DETAIL</a>) {
<a name="line199">199: </a>    <a href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPushTab.html#PetscViewerASCIIPushTab">PetscViewerASCIIPushTab</a>(v);
<a name="line200">200: </a>    <font color="#4169E1">for</font> (f = 0; f &lt; pdim; ++f) {
<a name="line201">201: </a>      <a href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(v, <font color="#666666">"Dual basis vector %D\n"</font>, f);
<a name="line202">202: </a>      <a href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPushTab.html#PetscViewerASCIIPushTab">PetscViewerASCIIPushTab</a>(v);
<a name="line203">203: </a>      <a href="../../../../../docs/manualpages/DT/PetscQuadratureView.html#PetscQuadratureView">PetscQuadratureView</a>(sp-&gt;functional[f], v);
<a name="line204">204: </a>      <a href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPopTab.html#PetscViewerASCIIPopTab">PetscViewerASCIIPopTab</a>(v);
<a name="line205">205: </a>    }
<a name="line206">206: </a>    <a href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPopTab.html#PetscViewerASCIIPopTab">PetscViewerASCIIPopTab</a>(v);
<a name="line207">207: </a>  }
<a name="line208">208: </a>  <a href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPopTab.html#PetscViewerASCIIPopTab">PetscViewerASCIIPopTab</a>(v);
<a name="line209">209: </a>  <font color="#4169E1">return</font>(0);
<a name="line210">210: </a>}

<a name="line212">212: </a><font color="#B22222">/*@</font>
<a name="line213">213: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceView.html#PetscDualSpaceView">PetscDualSpaceView</a> - Views a <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>

<a name="line215">215: </a><font color="#B22222">  Collective on sp</font>

<a name="line217">217: </a><font color="#B22222">  Input Parameter:</font>
<a name="line218">218: </a><font color="#B22222">+ sp - the <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> object to view</font>
<a name="line219">219: </a><font color="#B22222">- v  - the viewer</font>

<a name="line221">221: </a><font color="#B22222">  Level: beginner</font>

<a name="line223">223: </a><font color="#B22222">.seealso <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceDestroy.html#PetscDualSpaceDestroy">PetscDualSpaceDestroy</a>()</font>
<a name="line224">224: </a><font color="#B22222">@*/</font>
<a name="line225">225: </a><strong><font color="#4169E1"><a name="PetscDualSpaceView"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceView.html#PetscDualSpaceView">PetscDualSpaceView</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, <a href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</a> v)</font></strong>
<a name="line226">226: </a>{
<a name="line227">227: </a>  <a href="../../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a>      iascii;

<a name="line233">233: </a>  <font color="#4169E1">if</font> (!v) {<a href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIGetStdout.html#PetscViewerASCIIGetStdout">PetscViewerASCIIGetStdout</a>(<a href="../../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) sp), &amp;v);}
<a name="line234">234: </a>  <a href="../../../../../docs/manualpages/Sys/PetscObjectTypeCompare.html#PetscObjectTypeCompare">PetscObjectTypeCompare</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) v, <a href="../../../../../docs/manualpages/Viewer/PETSCVIEWERASCII.html#PETSCVIEWERASCII">PETSCVIEWERASCII</a>, &amp;iascii);
<a name="line235">235: </a>  <font color="#4169E1">if</font> (iascii) {PetscDualSpaceView_ASCII(sp, v);}
<a name="line236">236: </a>  <font color="#4169E1">return</font>(0);
<a name="line237">237: </a>}

<a name="line239">239: </a><font color="#B22222">/*@</font>
<a name="line240">240: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetFromOptions.html#PetscDualSpaceSetFromOptions">PetscDualSpaceSetFromOptions</a> - sets parameters in a <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> from the options database</font>

<a name="line242">242: </a><font color="#B22222">  Collective on sp</font>

<a name="line244">244: </a><font color="#B22222">  Input Parameter:</font>
<a name="line245">245: </a><font color="#B22222">. sp - the <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> object to set options for</font>

<a name="line247">247: </a><font color="#B22222">  Options Database:</font>
<a name="line248">248: </a><font color="#B22222">. -petscspace_degree the approximation order of the space</font>

<a name="line250">250: </a><font color="#B22222">  Level: intermediate</font>

<a name="line252">252: </a><font color="#B22222">.seealso <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceView.html#PetscDualSpaceView">PetscDualSpaceView</a>()</font>
<a name="line253">253: </a><font color="#B22222">@*/</font>
<a name="line254">254: </a><strong><font color="#4169E1"><a name="PetscDualSpaceSetFromOptions"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetFromOptions.html#PetscDualSpaceSetFromOptions">PetscDualSpaceSetFromOptions</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp)</font></strong>
<a name="line255">255: </a>{
<a name="line256">256: </a>  <a href="../../../../../docs/manualpages/FE/PetscDualSpaceReferenceCell.html#PetscDualSpaceReferenceCell">PetscDualSpaceReferenceCell</a> refCell = PETSCDUALSPACE_REFCELL_SIMPLEX;
<a name="line257">257: </a>  <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>                    refDim  = 0;
<a name="line258">258: </a>  <a href="../../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a>                   flg;
<a name="line259">259: </a>  const char                 *defaultType;
<a name="line260">260: </a>  char                        name[256];
<a name="line261">261: </a>  <a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a>              ierr;

<a name="line265">265: </a>  <font color="#4169E1">if</font> (!((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) sp)-&gt;type_name) {
<a name="line266">266: </a>    defaultType = <a href="../../../../../docs/manualpages/DUALSPACE/PETSCDUALSPACELAGRANGE.html#PETSCDUALSPACELAGRANGE">PETSCDUALSPACELAGRANGE</a>;
<a name="line267">267: </a>  } <font color="#4169E1">else</font> {
<a name="line268">268: </a>    defaultType = ((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) sp)-&gt;type_name;
<a name="line269">269: </a>  }
<a name="line270">270: </a>  <font color="#4169E1">if</font> (!PetscSpaceRegisterAllCalled) {<a href="../../../../../docs/manualpages/DM/PetscSpaceRegisterAll.html#PetscSpaceRegisterAll">PetscSpaceRegisterAll</a>();}

<a name="line272">272: </a>  <a href="../../../../../docs/manualpages/Sys/PetscObjectOptionsBegin.html#PetscObjectOptionsBegin">PetscObjectOptionsBegin</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) sp);
<a name="line273">273: </a>  <a href="../../../../../docs/manualpages/Sys/PetscOptionsFList.html#PetscOptionsFList">PetscOptionsFList</a>(<font color="#666666">"-petscdualspace_type"</font>, <font color="#666666">"Dual space"</font>, <font color="#666666">"<a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetType.html#PetscDualSpaceSetType">PetscDualSpaceSetType</a>"</font>, PetscDualSpaceList, defaultType, name, 256, &amp;flg);
<a name="line274">274: </a>  <font color="#4169E1">if</font> (flg) {
<a name="line275">275: </a>    <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetType.html#PetscDualSpaceSetType">PetscDualSpaceSetType</a>(sp, name);
<a name="line276">276: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (!((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) sp)-&gt;type_name) {
<a name="line277">277: </a>    <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetType.html#PetscDualSpaceSetType">PetscDualSpaceSetType</a>(sp, defaultType);
<a name="line278">278: </a>  }
<a name="line279">279: </a>  <a href="../../../../../docs/manualpages/Sys/PetscOptionsBoundedInt.html#PetscOptionsBoundedInt">PetscOptionsBoundedInt</a>(<font color="#666666">"-petscdualspace_degree"</font>, <font color="#666666">"The approximation order"</font>, <font color="#666666">"<a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetOrder.html#PetscDualSpaceSetOrder">PetscDualSpaceSetOrder</a>"</font>, sp-&gt;order, &amp;sp-&gt;order, NULL,0);
<a name="line280">280: </a>  <a href="../../../../../docs/manualpages/Sys/PetscOptionsBoundedInt.html#PetscOptionsBoundedInt">PetscOptionsBoundedInt</a>(<font color="#666666">"-petscdualspace_components"</font>, <font color="#666666">"The number of components"</font>, <font color="#666666">"<a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetNumComponents.html#PetscDualSpaceSetNumComponents">PetscDualSpaceSetNumComponents</a>"</font>, sp-&gt;Nc, &amp;sp-&gt;Nc, NULL,1);
<a name="line281">281: </a>  <font color="#4169E1">if</font> (sp-&gt;ops-&gt;setfromoptions) {
<a name="line282">282: </a>    (*sp-&gt;ops-&gt;setfromoptions)(PetscOptionsObject,sp);
<a name="line283">283: </a>  }
<a name="line284">284: </a>  <a href="../../../../../docs/manualpages/Sys/PetscOptionsBoundedInt.html#PetscOptionsBoundedInt">PetscOptionsBoundedInt</a>(<font color="#666666">"-petscdualspace_refdim"</font>, <font color="#666666">"The spatial dimension of the reference cell"</font>, <font color="#666666">"PetscDualSpaceSetReferenceCell"</font>, refDim, &amp;refDim, NULL,0);
<a name="line285">285: </a>  <a href="../../../../../docs/manualpages/Sys/PetscOptionsEnum.html#PetscOptionsEnum">PetscOptionsEnum</a>(<font color="#666666">"-petscdualspace_refcell"</font>, <font color="#666666">"Reference cell"</font>, <font color="#666666">"PetscDualSpaceSetReferenceCell"</font>, PetscDualSpaceReferenceCells, (<a href="../../../../../docs/manualpages/Sys/PetscEnum.html#PetscEnum">PetscEnum</a>) refCell, (<a href="../../../../../docs/manualpages/Sys/PetscEnum.html#PetscEnum">PetscEnum</a> *) &amp;refCell, &amp;flg);
<a name="line286">286: </a>  <font color="#4169E1">if</font> (flg) {
<a name="line287">287: </a>    <a href="../../../../../docs/manualpages/DM/DM.html#DM">DM</a> K;

<a name="line289">289: </a>    <font color="#4169E1">if</font> (!refDim) <a href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</a>(<a href="../../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) sp), PETSC_ERR_ARG_INCOMP, <font color="#666666">"Reference cell specified without a dimension. Use -petscdualspace_refdim."</font>);
<a name="line290">290: </a>    <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreateReferenceCell.html#PetscDualSpaceCreateReferenceCell">PetscDualSpaceCreateReferenceCell</a>(sp, refDim, refCell == PETSCDUALSPACE_REFCELL_SIMPLEX ? <a href="../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</a> : <a href="../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</a>, &amp;K);
<a name="line291">291: </a>    <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetDM.html#PetscDualSpaceSetDM">PetscDualSpaceSetDM</a>(sp, K);
<a name="line292">292: </a>    <a href="../../../../../docs/manualpages/DM/DMDestroy.html#DMDestroy">DMDestroy</a>(&amp;K);
<a name="line293">293: </a>  }

<a name="line295">295: </a>  <font color="#B22222">/* process any options handlers added with <a href="../../../../../docs/manualpages/Sys/PetscObjectAddOptionsHandler.html#PetscObjectAddOptionsHandler">PetscObjectAddOptionsHandler</a>() */</font>
<a name="line296">296: </a>  <a href="../../../../../docs/manualpages/Sys/PetscObjectProcessOptionsHandlers.html#PetscObjectProcessOptionsHandlers">PetscObjectProcessOptionsHandlers</a>(PetscOptionsObject,(<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) sp);
<a name="line297">297: </a>  <a href="../../../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</a>();
<a name="line298">298: </a>  sp-&gt;setfromoptionscalled = <a href="../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</a>;
<a name="line299">299: </a>  <font color="#4169E1">return</font>(0);
<a name="line300">300: </a>}

<a name="line302">302: </a><font color="#B22222">/*@</font>
<a name="line303">303: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetUp.html#PetscDualSpaceSetUp">PetscDualSpaceSetUp</a> - Construct a basis for the <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>

<a name="line305">305: </a><font color="#B22222">  Collective on sp</font>

<a name="line307">307: </a><font color="#B22222">  Input Parameter:</font>
<a name="line308">308: </a><font color="#B22222">. sp - the <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> object to setup</font>

<a name="line310">310: </a><font color="#B22222">  Level: intermediate</font>

<a name="line312">312: </a><font color="#B22222">.seealso <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceView.html#PetscDualSpaceView">PetscDualSpaceView</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceDestroy.html#PetscDualSpaceDestroy">PetscDualSpaceDestroy</a>()</font>
<a name="line313">313: </a><font color="#B22222">@*/</font>
<a name="line314">314: </a><strong><font color="#4169E1"><a name="PetscDualSpaceSetUp"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetUp.html#PetscDualSpaceSetUp">PetscDualSpaceSetUp</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp)</font></strong>
<a name="line315">315: </a>{

<a name="line320">320: </a>  <font color="#4169E1">if</font> (sp-&gt;setupcalled) <font color="#4169E1">return</font>(0);
<a name="line321">321: </a>  sp-&gt;setupcalled = <a href="../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</a>;
<a name="line322">322: </a>  <font color="#4169E1">if</font> (sp-&gt;ops-&gt;setup) {(*sp-&gt;ops-&gt;setup)(sp);}
<a name="line323">323: </a>  <font color="#4169E1">if</font> (sp-&gt;setfromoptionscalled) {PetscDualSpaceViewFromOptions(sp, NULL, <font color="#666666">"-petscdualspace_view"</font>);}
<a name="line324">324: </a>  <font color="#4169E1">return</font>(0);
<a name="line325">325: </a>}

<a name="line327">327: </a><font color="#B22222">/*@</font>
<a name="line328">328: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceDestroy.html#PetscDualSpaceDestroy">PetscDualSpaceDestroy</a> - Destroys a <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> object</font>

<a name="line330">330: </a><font color="#B22222">  Collective on sp</font>

<a name="line332">332: </a><font color="#B22222">  Input Parameter:</font>
<a name="line333">333: </a><font color="#B22222">. sp - the <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> object to destroy</font>

<a name="line335">335: </a><font color="#B22222">  Level: beginner</font>

<a name="line337">337: </a><font color="#B22222">.seealso <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceView.html#PetscDualSpaceView">PetscDualSpaceView</a>()</font>
<a name="line338">338: </a><font color="#B22222">@*/</font>
<a name="line339">339: </a><strong><font color="#4169E1"><a name="PetscDualSpaceDestroy"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceDestroy.html#PetscDualSpaceDestroy">PetscDualSpaceDestroy</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> *sp)</font></strong>
<a name="line340">340: </a>{
<a name="line341">341: </a>  <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>       dim, f;

<a name="line345">345: </a>  <font color="#4169E1">if</font> (!*sp) <font color="#4169E1">return</font>(0);

<a name="line348">348: </a>  <font color="#4169E1">if</font> (--((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>)(*sp))-&gt;refct &gt; 0) {*sp = 0; <font color="#4169E1">return</font>(0);}
<a name="line349">349: </a>  ((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) (*sp))-&gt;refct = 0;

<a name="line351">351: </a>  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetDimension.html#PetscDualSpaceGetDimension">PetscDualSpaceGetDimension</a>(*sp, &amp;dim);
<a name="line352">352: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; dim; ++f) {
<a name="line353">353: </a>    <a href="../../../../../docs/manualpages/DT/PetscQuadratureDestroy.html#PetscQuadratureDestroy">PetscQuadratureDestroy</a>(&amp;(*sp)-&gt;functional[f]);
<a name="line354">354: </a>  }
<a name="line355">355: </a>  <a href="../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>((*sp)-&gt;functional);
<a name="line356">356: </a>  <a href="../../../../../docs/manualpages/DT/PetscQuadratureDestroy.html#PetscQuadratureDestroy">PetscQuadratureDestroy</a>(&amp;(*sp)-&gt;allPoints);
<a name="line357">357: </a>  <a href="../../../../../docs/manualpages/DM/DMDestroy.html#DMDestroy">DMDestroy</a>(&amp;(*sp)-&gt;dm);

<a name="line359">359: </a>  <font color="#4169E1">if</font> ((*sp)-&gt;ops-&gt;destroy) {(*(*sp)-&gt;ops-&gt;destroy)(*sp);}
<a name="line360">360: </a>  <a href="../../../../../docs/manualpages/Sys/PetscHeaderDestroy.html#PetscHeaderDestroy">PetscHeaderDestroy</a>(sp);
<a name="line361">361: </a>  <font color="#4169E1">return</font>(0);
<a name="line362">362: </a>}

<a name="line364">364: </a><font color="#B22222">/*@</font>
<a name="line365">365: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a> - Creates an empty <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> object. The type can then be set with <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetType.html#PetscDualSpaceSetType">PetscDualSpaceSetType</a>().</font>

<a name="line367">367: </a><font color="#B22222">  Collective</font>

<a name="line369">369: </a><font color="#B22222">  Input Parameter:</font>
<a name="line370">370: </a><font color="#B22222">. comm - The communicator for the <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> object</font>

<a name="line372">372: </a><font color="#B22222">  Output Parameter:</font>
<a name="line373">373: </a><font color="#B22222">. sp - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> object</font>

<a name="line375">375: </a><font color="#B22222">  Level: beginner</font>

<a name="line377">377: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetType.html#PetscDualSpaceSetType">PetscDualSpaceSetType</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PETSCDUALSPACELAGRANGE.html#PETSCDUALSPACELAGRANGE">PETSCDUALSPACELAGRANGE</a></font>
<a name="line378">378: </a><font color="#B22222">@*/</font>
<a name="line379">379: </a><strong><font color="#4169E1"><a name="PetscDualSpaceCreate"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>(<a href="../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</a> comm, <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> *sp)</font></strong>
<a name="line380">380: </a>{
<a name="line381">381: </a>  <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> s;

<a name="line386">386: </a>  <a href="../../../../../docs/manualpages/Sys/PetscCitationsRegister.html#PetscCitationsRegister">PetscCitationsRegister</a>(FECitation,&amp;FEcite);
<a name="line387">387: </a>  *sp  = NULL;
<a name="line388">388: </a>  <a href="../../../../../docs/manualpages/DM/PetscFEInitializePackage.html#PetscFEInitializePackage">PetscFEInitializePackage</a>();

<a name="line390">390: </a>  <a href="../../../../../docs/manualpages/Sys/PetscHeaderCreate.html#PetscHeaderCreate">PetscHeaderCreate</a>(s, PETSCDUALSPACE_CLASSID, <font color="#666666">"<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a>"</font>, <font color="#666666">"Dual Space"</font>, <font color="#666666">"<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a>"</font>, comm, <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceDestroy.html#PetscDualSpaceDestroy">PetscDualSpaceDestroy</a>, <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceView.html#PetscDualSpaceView">PetscDualSpaceView</a>);

<a name="line392">392: </a>  s-&gt;order = 0;
<a name="line393">393: </a>  s-&gt;Nc    = 1;
<a name="line394">394: </a>  s-&gt;k     = 0;
<a name="line395">395: </a>  s-&gt;setupcalled = <a href="../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</a>;

<a name="line397">397: </a>  *sp = s;
<a name="line398">398: </a>  <font color="#4169E1">return</font>(0);
<a name="line399">399: </a>}

<a name="line401">401: </a><font color="#B22222">/*@</font>
<a name="line402">402: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceDuplicate.html#PetscDualSpaceDuplicate">PetscDualSpaceDuplicate</a> - Creates a duplicate <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> object, however it is not setup.</font>

<a name="line404">404: </a><font color="#B22222">  Collective on sp</font>

<a name="line406">406: </a><font color="#B22222">  Input Parameter:</font>
<a name="line407">407: </a><font color="#B22222">. sp - The original <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>

<a name="line409">409: </a><font color="#B22222">  Output Parameter:</font>
<a name="line410">410: </a><font color="#B22222">. spNew - The duplicate <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>

<a name="line412">412: </a><font color="#B22222">  Level: beginner</font>

<a name="line414">414: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetType.html#PetscDualSpaceSetType">PetscDualSpaceSetType</a>()</font>
<a name="line415">415: </a><font color="#B22222">@*/</font>
<a name="line416">416: </a><strong><font color="#4169E1"><a name="PetscDualSpaceDuplicate"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceDuplicate.html#PetscDualSpaceDuplicate">PetscDualSpaceDuplicate</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> *spNew)</font></strong>
<a name="line417">417: </a>{

<a name="line423">423: </a>  (*sp-&gt;ops-&gt;duplicate)(sp, spNew);
<a name="line424">424: </a>  <font color="#4169E1">return</font>(0);
<a name="line425">425: </a>}

<a name="line427">427: </a><font color="#B22222">/*@</font>
<a name="line428">428: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetDM.html#PetscDualSpaceGetDM">PetscDualSpaceGetDM</a> - Get the <a href="../../../../../docs/manualpages/DM/DM.html#DM">DM</a> representing the reference cell</font>

<a name="line430">430: </a><font color="#B22222">  Not collective</font>

<a name="line432">432: </a><font color="#B22222">  Input Parameter:</font>
<a name="line433">433: </a><font color="#B22222">. sp - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>

<a name="line435">435: </a><font color="#B22222">  Output Parameter:</font>
<a name="line436">436: </a><font color="#B22222">. dm - The reference cell</font>

<a name="line438">438: </a><font color="#B22222">  Level: intermediate</font>

<a name="line440">440: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetDM.html#PetscDualSpaceSetDM">PetscDualSpaceSetDM</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>()</font>
<a name="line441">441: </a><font color="#B22222">@*/</font>
<a name="line442">442: </a><strong><font color="#4169E1"><a name="PetscDualSpaceGetDM"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetDM.html#PetscDualSpaceGetDM">PetscDualSpaceGetDM</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, <a href="../../../../../docs/manualpages/DM/DM.html#DM">DM</a> *dm)</font></strong>
<a name="line443">443: </a>{
<a name="line447">447: </a>  *dm = sp-&gt;dm;
<a name="line448">448: </a>  <font color="#4169E1">return</font>(0);
<a name="line449">449: </a>}

<a name="line451">451: </a><font color="#B22222">/*@</font>
<a name="line452">452: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetDM.html#PetscDualSpaceSetDM">PetscDualSpaceSetDM</a> - Get the <a href="../../../../../docs/manualpages/DM/DM.html#DM">DM</a> representing the reference cell</font>

<a name="line454">454: </a><font color="#B22222">  Not collective</font>

<a name="line456">456: </a><font color="#B22222">  Input Parameters:</font>
<a name="line457">457: </a><font color="#B22222">+ sp - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>
<a name="line458">458: </a><font color="#B22222">- dm - The reference cell</font>

<a name="line460">460: </a><font color="#B22222">  Level: intermediate</font>

<a name="line462">462: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetDM.html#PetscDualSpaceGetDM">PetscDualSpaceGetDM</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>()</font>
<a name="line463">463: </a><font color="#B22222">@*/</font>
<a name="line464">464: </a><strong><font color="#4169E1"><a name="PetscDualSpaceSetDM"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetDM.html#PetscDualSpaceSetDM">PetscDualSpaceSetDM</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, <a href="../../../../../docs/manualpages/DM/DM.html#DM">DM</a> dm)</font></strong>
<a name="line465">465: </a>{

<a name="line471">471: </a>  <a href="../../../../../docs/manualpages/DM/DMDestroy.html#DMDestroy">DMDestroy</a>(&amp;sp-&gt;dm);
<a name="line472">472: </a>  <a href="../../../../../docs/manualpages/Sys/PetscObjectReference.html#PetscObjectReference">PetscObjectReference</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) dm);
<a name="line473">473: </a>  sp-&gt;dm = dm;
<a name="line474">474: </a>  <font color="#4169E1">return</font>(0);
<a name="line475">475: </a>}

<a name="line477">477: </a><font color="#B22222">/*@</font>
<a name="line478">478: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetOrder.html#PetscDualSpaceGetOrder">PetscDualSpaceGetOrder</a> - Get the order of the dual space</font>

<a name="line480">480: </a><font color="#B22222">  Not collective</font>

<a name="line482">482: </a><font color="#B22222">  Input Parameter:</font>
<a name="line483">483: </a><font color="#B22222">. sp - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>

<a name="line485">485: </a><font color="#B22222">  Output Parameter:</font>
<a name="line486">486: </a><font color="#B22222">. order - The order</font>

<a name="line488">488: </a><font color="#B22222">  Level: intermediate</font>

<a name="line490">490: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetOrder.html#PetscDualSpaceSetOrder">PetscDualSpaceSetOrder</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>()</font>
<a name="line491">491: </a><font color="#B22222">@*/</font>
<a name="line492">492: </a><strong><font color="#4169E1"><a name="PetscDualSpaceGetOrder"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetOrder.html#PetscDualSpaceGetOrder">PetscDualSpaceGetOrder</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *order)</font></strong>
<a name="line493">493: </a>{
<a name="line497">497: </a>  *order = sp-&gt;order;
<a name="line498">498: </a>  <font color="#4169E1">return</font>(0);
<a name="line499">499: </a>}

<a name="line501">501: </a><font color="#B22222">/*@</font>
<a name="line502">502: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetOrder.html#PetscDualSpaceSetOrder">PetscDualSpaceSetOrder</a> - Set the order of the dual space</font>

<a name="line504">504: </a><font color="#B22222">  Not collective</font>

<a name="line506">506: </a><font color="#B22222">  Input Parameters:</font>
<a name="line507">507: </a><font color="#B22222">+ sp - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>
<a name="line508">508: </a><font color="#B22222">- order - The order</font>

<a name="line510">510: </a><font color="#B22222">  Level: intermediate</font>

<a name="line512">512: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetOrder.html#PetscDualSpaceGetOrder">PetscDualSpaceGetOrder</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>()</font>
<a name="line513">513: </a><font color="#B22222">@*/</font>
<a name="line514">514: </a><strong><font color="#4169E1"><a name="PetscDualSpaceSetOrder"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetOrder.html#PetscDualSpaceSetOrder">PetscDualSpaceSetOrder</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> order)</font></strong>
<a name="line515">515: </a>{
<a name="line518">518: </a>  sp-&gt;order = order;
<a name="line519">519: </a>  <font color="#4169E1">return</font>(0);
<a name="line520">520: </a>}

<a name="line522">522: </a><font color="#B22222">/*@</font>
<a name="line523">523: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetNumComponents.html#PetscDualSpaceGetNumComponents">PetscDualSpaceGetNumComponents</a> - Return the number of components for this space</font>

<a name="line525">525: </a><font color="#B22222">  Input Parameter:</font>
<a name="line526">526: </a><font color="#B22222">. sp - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>

<a name="line528">528: </a><font color="#B22222">  Output Parameter:</font>
<a name="line529">529: </a><font color="#B22222">. Nc - The number of components</font>

<a name="line531">531: </a><font color="#B22222">  Note: A vector space, for example, will have d components, where d is the spatial dimension</font>

<a name="line533">533: </a><font color="#B22222">  Level: intermediate</font>

<a name="line535">535: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetNumComponents.html#PetscDualSpaceSetNumComponents">PetscDualSpaceSetNumComponents</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetDimension.html#PetscDualSpaceGetDimension">PetscDualSpaceGetDimension</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>(), <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>
<a name="line536">536: </a><font color="#B22222">@*/</font>
<a name="line537">537: </a><strong><font color="#4169E1"><a name="PetscDualSpaceGetNumComponents"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetNumComponents.html#PetscDualSpaceGetNumComponents">PetscDualSpaceGetNumComponents</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *Nc)</font></strong>
<a name="line538">538: </a>{
<a name="line542">542: </a>  *Nc = sp-&gt;Nc;
<a name="line543">543: </a>  <font color="#4169E1">return</font>(0);
<a name="line544">544: </a>}

<a name="line546">546: </a><font color="#B22222">/*@</font>
<a name="line547">547: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetNumComponents.html#PetscDualSpaceSetNumComponents">PetscDualSpaceSetNumComponents</a> - Set the number of components for this space</font>

<a name="line549">549: </a><font color="#B22222">  Input Parameters:</font>
<a name="line550">550: </a><font color="#B22222">+ sp - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>
<a name="line551">551: </a><font color="#B22222">- order - The number of components</font>

<a name="line553">553: </a><font color="#B22222">  Level: intermediate</font>

<a name="line555">555: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetNumComponents.html#PetscDualSpaceGetNumComponents">PetscDualSpaceGetNumComponents</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>(), <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>
<a name="line556">556: </a><font color="#B22222">@*/</font>
<a name="line557">557: </a><strong><font color="#4169E1"><a name="PetscDualSpaceSetNumComponents"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceSetNumComponents.html#PetscDualSpaceSetNumComponents">PetscDualSpaceSetNumComponents</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nc)</font></strong>
<a name="line558">558: </a>{
<a name="line561">561: </a>  sp-&gt;Nc = Nc;
<a name="line562">562: </a>  <font color="#4169E1">return</font>(0);
<a name="line563">563: </a>}

<a name="line565">565: </a><font color="#B22222">/*@</font>
<a name="line566">566: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetFunctional.html#PetscDualSpaceGetFunctional">PetscDualSpaceGetFunctional</a> - Get the i-th basis functional in the dual space</font>

<a name="line568">568: </a><font color="#B22222">  Not collective</font>

<a name="line570">570: </a><font color="#B22222">  Input Parameters:</font>
<a name="line571">571: </a><font color="#B22222">+ sp - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>
<a name="line572">572: </a><font color="#B22222">- i  - The basis number</font>

<a name="line574">574: </a><font color="#B22222">  Output Parameter:</font>
<a name="line575">575: </a><font color="#B22222">. functional - The basis functional</font>

<a name="line577">577: </a><font color="#B22222">  Level: intermediate</font>

<a name="line579">579: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetDimension.html#PetscDualSpaceGetDimension">PetscDualSpaceGetDimension</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>()</font>
<a name="line580">580: </a><font color="#B22222">@*/</font>
<a name="line581">581: </a><strong><font color="#4169E1"><a name="PetscDualSpaceGetFunctional"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetFunctional.html#PetscDualSpaceGetFunctional">PetscDualSpaceGetFunctional</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> i, <a href="../../../../../docs/manualpages/FE/PetscQuadrature.html#PetscQuadrature">PetscQuadrature</a> *functional)</font></strong>
<a name="line582">582: </a>{
<a name="line583">583: </a>  <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>       dim;

<a name="line589">589: </a>  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetDimension.html#PetscDualSpaceGetDimension">PetscDualSpaceGetDimension</a>(sp, &amp;dim);
<a name="line590">590: </a>  <font color="#4169E1">if</font> ((i &lt; 0) || (i &gt;= dim)) <a href="../../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Functional index %d must be in [0, %d)"</font>, i, dim);
<a name="line591">591: </a>  *functional = sp-&gt;functional[i];
<a name="line592">592: </a>  <font color="#4169E1">return</font>(0);
<a name="line593">593: </a>}

<a name="line595">595: </a><font color="#B22222">/*@</font>
<a name="line596">596: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetDimension.html#PetscDualSpaceGetDimension">PetscDualSpaceGetDimension</a> - Get the dimension of the dual space, i.e. the number of basis functionals</font>

<a name="line598">598: </a><font color="#B22222">  Not collective</font>

<a name="line600">600: </a><font color="#B22222">  Input Parameter:</font>
<a name="line601">601: </a><font color="#B22222">. sp - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>

<a name="line603">603: </a><font color="#B22222">  Output Parameter:</font>
<a name="line604">604: </a><font color="#B22222">. dim - The dimension</font>

<a name="line606">606: </a><font color="#B22222">  Level: intermediate</font>

<a name="line608">608: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetFunctional.html#PetscDualSpaceGetFunctional">PetscDualSpaceGetFunctional</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>()</font>
<a name="line609">609: </a><font color="#B22222">@*/</font>
<a name="line610">610: </a><strong><font color="#4169E1"><a name="PetscDualSpaceGetDimension"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetDimension.html#PetscDualSpaceGetDimension">PetscDualSpaceGetDimension</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *dim)</font></strong>
<a name="line611">611: </a>{

<a name="line617">617: </a>  *dim = 0;
<a name="line618">618: </a>  <font color="#4169E1">if</font> (sp-&gt;ops-&gt;getdimension) {(*sp-&gt;ops-&gt;getdimension)(sp, dim);}
<a name="line619">619: </a>  <font color="#4169E1">return</font>(0);
<a name="line620">620: </a>}

<a name="line622">622: </a><font color="#B22222">/*@C</font>
<a name="line623">623: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetNumDof.html#PetscDualSpaceGetNumDof">PetscDualSpaceGetNumDof</a> - Get the number of degrees of freedom for each spatial (topological) dimension</font>

<a name="line625">625: </a><font color="#B22222">  Not collective</font>

<a name="line627">627: </a><font color="#B22222">  Input Parameter:</font>
<a name="line628">628: </a><font color="#B22222">. sp - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>

<a name="line630">630: </a><font color="#B22222">  Output Parameter:</font>
<a name="line631">631: </a><font color="#B22222">. numDof - An array of length dim+1 which holds the number of dofs for each dimension</font>

<a name="line633">633: </a><font color="#B22222">  Level: intermediate</font>

<a name="line635">635: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetFunctional.html#PetscDualSpaceGetFunctional">PetscDualSpaceGetFunctional</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>()</font>
<a name="line636">636: </a><font color="#B22222">@*/</font>
<a name="line637">637: </a><strong><font color="#4169E1"><a name="PetscDualSpaceGetNumDof"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetNumDof.html#PetscDualSpaceGetNumDof">PetscDualSpaceGetNumDof</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, const <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> **numDof)</font></strong>
<a name="line638">638: </a>{

<a name="line644">644: </a>  (*sp-&gt;ops-&gt;getnumdof)(sp, numDof);
<a name="line645">645: </a>  <font color="#4169E1">if</font> (!*numDof) <a href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</a>(<a href="../../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) sp), PETSC_ERR_LIB, <font color="#666666">"Empty numDof[] returned from dual space implementation"</font>);
<a name="line646">646: </a>  <font color="#4169E1">return</font>(0);
<a name="line647">647: </a>}

<a name="line649">649: </a><font color="#B22222">/*@</font>
<a name="line650">650: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreateSection.html#PetscDualSpaceCreateSection">PetscDualSpaceCreateSection</a> - Create a <a href="../../../../../docs/manualpages/PetscSection/PetscSection.html#PetscSection">PetscSection</a> over the reference cell with the layout from this space</font>

<a name="line652">652: </a><font color="#B22222">  Collective on sp</font>

<a name="line654">654: </a><font color="#B22222">  Input Parameters:</font>
<a name="line655">655: </a><font color="#B22222">+ sp      - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>

<a name="line657">657: </a><font color="#B22222">  Output Parameter:</font>
<a name="line658">658: </a><font color="#B22222">. section - The section</font>

<a name="line660">660: </a><font color="#B22222">  Level: advanced</font>

<a name="line662">662: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>(), <a href="../../../../../docs/manualpages/DMPLEX/DMPLEX.html#DMPLEX">DMPLEX</a></font>
<a name="line663">663: </a><font color="#B22222">@*/</font>
<a name="line664">664: </a><strong><font color="#4169E1"><a name="PetscDualSpaceCreateSection"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreateSection.html#PetscDualSpaceCreateSection">PetscDualSpaceCreateSection</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, <a href="../../../../../docs/manualpages/PetscSection/PetscSection.html#PetscSection">PetscSection</a> *section)</font></strong>
<a name="line665">665: </a>{
<a name="line666">666: </a>  <a href="../../../../../docs/manualpages/DM/DM.html#DM">DM</a>             dm;
<a name="line667">667: </a>  <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>       pStart, pEnd, depth, h, offset;
<a name="line668">668: </a>  const <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *numDof;

<a name="line672">672: </a>  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetDM.html#PetscDualSpaceGetDM">PetscDualSpaceGetDM</a>(sp,&amp;dm);
<a name="line673">673: </a>  <a href="../../../../../docs/manualpages/DMPLEX/DMPlexGetChart.html#DMPlexGetChart">DMPlexGetChart</a>(dm,&amp;pStart,&amp;pEnd);
<a name="line674">674: </a>  <a href="../../../../../docs/manualpages/PetscSection/PetscSectionCreate.html#PetscSectionCreate">PetscSectionCreate</a>(<a href="../../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>)sp),section);
<a name="line675">675: </a>  <a href="../../../../../docs/manualpages/PetscSection/PetscSectionSetChart.html#PetscSectionSetChart">PetscSectionSetChart</a>(*section,pStart,pEnd);
<a name="line676">676: </a>  <a href="../../../../../docs/manualpages/DMPLEX/DMPlexGetDepth.html#DMPlexGetDepth">DMPlexGetDepth</a>(dm,&amp;depth);
<a name="line677">677: </a>  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetNumDof.html#PetscDualSpaceGetNumDof">PetscDualSpaceGetNumDof</a>(sp,&amp;numDof);
<a name="line678">678: </a>  <font color="#4169E1">for</font> (h = 0; h &lt;= depth; h++) {
<a name="line679">679: </a>    <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> hStart, hEnd, p, dof;

<a name="line681">681: </a>    <a href="../../../../../docs/manualpages/DMPLEX/DMPlexGetHeightStratum.html#DMPlexGetHeightStratum">DMPlexGetHeightStratum</a>(dm,h,&amp;hStart,&amp;hEnd);
<a name="line682">682: </a>    dof = numDof[depth - h];
<a name="line683">683: </a>    <font color="#4169E1">for</font> (p = hStart; p &lt; hEnd; p++) {
<a name="line684">684: </a>      <a href="../../../../../docs/manualpages/PetscSection/PetscSectionSetDof.html#PetscSectionSetDof">PetscSectionSetDof</a>(*section,p,dof);
<a name="line685">685: </a>    }
<a name="line686">686: </a>  }
<a name="line687">687: </a>  <a href="../../../../../docs/manualpages/PetscSection/PetscSectionSetUp.html#PetscSectionSetUp">PetscSectionSetUp</a>(*section);
<a name="line688">688: </a>  <font color="#4169E1">for</font> (h = 0, offset = 0; h &lt;= depth; h++) {
<a name="line689">689: </a>    <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> hStart, hEnd, p, dof;

<a name="line691">691: </a>    <a href="../../../../../docs/manualpages/DMPLEX/DMPlexGetHeightStratum.html#DMPlexGetHeightStratum">DMPlexGetHeightStratum</a>(dm,h,&amp;hStart,&amp;hEnd);
<a name="line692">692: </a>    dof = numDof[depth - h];
<a name="line693">693: </a>    <font color="#4169E1">for</font> (p = hStart; p &lt; hEnd; p++) {
<a name="line694">694: </a>      <a href="../../../../../docs/manualpages/PetscSection/PetscSectionGetDof.html#PetscSectionGetDof">PetscSectionGetDof</a>(*section,p,&amp;dof);
<a name="line695">695: </a>      <a href="../../../../../docs/manualpages/PetscSection/PetscSectionSetOffset.html#PetscSectionSetOffset">PetscSectionSetOffset</a>(*section,p,offset);
<a name="line696">696: </a>      offset += dof;
<a name="line697">697: </a>    }
<a name="line698">698: </a>  }
<a name="line699">699: </a>  <font color="#4169E1">return</font>(0);
<a name="line700">700: </a>}

<a name="line702">702: </a><font color="#B22222">/*@</font>
<a name="line703">703: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreateReferenceCell.html#PetscDualSpaceCreateReferenceCell">PetscDualSpaceCreateReferenceCell</a> - Create a <a href="../../../../../docs/manualpages/DMPLEX/DMPLEX.html#DMPLEX">DMPLEX</a> with the appropriate FEM reference cell</font>

<a name="line705">705: </a><font color="#B22222">  Collective on sp</font>

<a name="line707">707: </a><font color="#B22222">  Input Parameters:</font>
<a name="line708">708: </a><font color="#B22222">+ sp      - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>
<a name="line709">709: </a><font color="#B22222">. dim     - The spatial dimension</font>
<a name="line710">710: </a><font color="#B22222">- simplex - Flag for simplex, otherwise use a tensor-product cell</font>

<a name="line712">712: </a><font color="#B22222">  Output Parameter:</font>
<a name="line713">713: </a><font color="#B22222">. refdm - The reference cell</font>

<a name="line715">715: </a><font color="#B22222">  Level: intermediate</font>

<a name="line717">717: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>(), <a href="../../../../../docs/manualpages/DMPLEX/DMPLEX.html#DMPLEX">DMPLEX</a></font>
<a name="line718">718: </a><font color="#B22222">@*/</font>
<a name="line719">719: </a><strong><font color="#4169E1"><a name="PetscDualSpaceCreateReferenceCell"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreateReferenceCell.html#PetscDualSpaceCreateReferenceCell">PetscDualSpaceCreateReferenceCell</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a> simplex, <a href="../../../../../docs/manualpages/DM/DM.html#DM">DM</a> *refdm)</font></strong>
<a name="line720">720: </a>{

<a name="line724">724: </a>  <a href="../../../../../docs/manualpages/DMPLEX/DMPlexCreateReferenceCell.html#DMPlexCreateReferenceCell">DMPlexCreateReferenceCell</a>(<a href="../../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) sp), dim, simplex, refdm);
<a name="line725">725: </a>  <font color="#4169E1">return</font>(0);
<a name="line726">726: </a>}

<a name="line728">728: </a><font color="#B22222">/*@C</font>
<a name="line729">729: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceApply.html#PetscDualSpaceApply">PetscDualSpaceApply</a> - Apply a functional from the dual space basis to an input function</font>

<a name="line731">731: </a><font color="#B22222">  Input Parameters:</font>
<a name="line732">732: </a><font color="#B22222">+ sp      - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> object</font>
<a name="line733">733: </a><font color="#B22222">. f       - The basis functional index</font>
<a name="line734">734: </a><font color="#B22222">. time    - The time</font>
<a name="line735">735: </a><font color="#B22222">. cgeom   - A context with geometric information for this cell, we use v0 (the initial vertex) and J (the Jacobian) (or evaluated at the coordinates of the functional)</font>
<a name="line736">736: </a><font color="#B22222">. numComp - The number of components for the function</font>
<a name="line737">737: </a><font color="#B22222">. func    - The input function</font>
<a name="line738">738: </a><font color="#B22222">- ctx     - A context for the function</font>

<a name="line740">740: </a><font color="#B22222">  Output Parameter:</font>
<a name="line741">741: </a><font color="#B22222">. value   - numComp output values</font>

<a name="line743">743: </a><font color="#B22222">  Note: The calling sequence for the callback func is given by:</font>

<a name="line745">745: </a><font color="#B22222">$ func(<a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> time, const <a href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[],</font>
<a name="line746">746: </a><font color="#B22222">$      <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numComponents, <a href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> values[], void *ctx)</font>

<a name="line748">748: </a><font color="#B22222">  Level: beginner</font>

<a name="line750">750: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>()</font>
<a name="line751">751: </a><font color="#B22222">@*/</font>
<a name="line752">752: </a><strong><font color="#4169E1"><a name="PetscDualSpaceApply"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceApply.html#PetscDualSpaceApply">PetscDualSpaceApply</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> time, PetscFEGeom *cgeom, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numComp, <a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> (*func)(<a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>, <a href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a>, const <a href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> [], <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>, <a href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> *, void *), void *ctx, <a href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> *value)</font></strong>
<a name="line753">753: </a>{

<a name="line760">760: </a>  (*sp-&gt;ops-&gt;apply)(sp, f, time, cgeom, numComp, func, ctx, value);
<a name="line761">761: </a>  <font color="#4169E1">return</font>(0);
<a name="line762">762: </a>}

<a name="line764">764: </a><font color="#B22222">/*@C</font>
<a name="line765">765: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceApplyAll.html#PetscDualSpaceApplyAll">PetscDualSpaceApplyAll</a> - Apply all functionals from the dual space basis to the result of an evaluation at the points returned by <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetAllPoints.html#PetscDualSpaceGetAllPoints">PetscDualSpaceGetAllPoints</a>()</font>

<a name="line767">767: </a><font color="#B22222">  Input Parameters:</font>
<a name="line768">768: </a><font color="#B22222">+ sp        - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> object</font>
<a name="line769">769: </a><font color="#B22222">- pointEval - Evaluation at the points returned by <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetAllPoints.html#PetscDualSpaceGetAllPoints">PetscDualSpaceGetAllPoints</a>()</font>

<a name="line771">771: </a><font color="#B22222">  Output Parameter:</font>
<a name="line772">772: </a><font color="#B22222">. spValue   - The values of all dual space functionals</font>

<a name="line774">774: </a><font color="#B22222">  Level: beginner</font>

<a name="line776">776: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>()</font>
<a name="line777">777: </a><font color="#B22222">@*/</font>
<a name="line778">778: </a><strong><font color="#4169E1"><a name="PetscDualSpaceApplyAll"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceApplyAll.html#PetscDualSpaceApplyAll">PetscDualSpaceApplyAll</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, const <a href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> *pointEval, <a href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> *spValue)</font></strong>
<a name="line779">779: </a>{

<a name="line784">784: </a>  (*sp-&gt;ops-&gt;applyall)(sp, pointEval, spValue);
<a name="line785">785: </a>  <font color="#4169E1">return</font>(0);
<a name="line786">786: </a>}

<a name="line788">788: </a><font color="#B22222">/*@C</font>
<a name="line789">789: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceApplyDefault.html#PetscDualSpaceApplyDefault">PetscDualSpaceApplyDefault</a> - Apply a functional from the dual space basis to an input function by assuming a point evaluation functional.</font>

<a name="line791">791: </a><font color="#B22222">  Input Parameters:</font>
<a name="line792">792: </a><font color="#B22222">+ sp    - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> object</font>
<a name="line793">793: </a><font color="#B22222">. f     - The basis functional index</font>
<a name="line794">794: </a><font color="#B22222">. time  - The time</font>
<a name="line795">795: </a><font color="#B22222">. cgeom - A context with geometric information for this cell, we use v0 (the initial vertex) and J (the Jacobian)</font>
<a name="line796">796: </a><font color="#B22222">. Nc    - The number of components for the function</font>
<a name="line797">797: </a><font color="#B22222">. func  - The input function</font>
<a name="line798">798: </a><font color="#B22222">- ctx   - A context for the function</font>

<a name="line800">800: </a><font color="#B22222">  Output Parameter:</font>
<a name="line801">801: </a><font color="#B22222">. value   - The output value</font>

<a name="line803">803: </a><font color="#B22222">  Note: The calling sequence for the callback func is given by:</font>

<a name="line805">805: </a><font color="#B22222">$ func(<a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> time, const <a href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[],</font>
<a name="line806">806: </a><font color="#B22222">$      <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numComponents, <a href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> values[], void *ctx)</font>

<a name="line808">808: </a><font color="#B22222">and the idea is to evaluate the functional as an integral</font>

<a name="line810">810: </a><font color="#B22222">$ n(f) = int dx n(x) . f(x)</font>

<a name="line812">812: </a><font color="#B22222">where both n and f have Nc components.</font>

<a name="line814">814: </a><font color="#B22222">  Level: beginner</font>

<a name="line816">816: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>()</font>
<a name="line817">817: </a><font color="#B22222">@*/</font>
<a name="line818">818: </a><strong><font color="#4169E1"><a name="PetscDualSpaceApplyDefault"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceApplyDefault.html#PetscDualSpaceApplyDefault">PetscDualSpaceApplyDefault</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> time, PetscFEGeom *cgeom, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nc, <a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> (*func)(<a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>, <a href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a>, const <a href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> [], <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>, <a href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> *, void *), void *ctx, <a href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> *value)</font></strong>
<a name="line819">819: </a>{
<a name="line820">820: </a>  <a href="../../../../../docs/manualpages/DM/DM.html#DM">DM</a>               dm;
<a name="line821">821: </a>  <a href="../../../../../docs/manualpages/FE/PetscQuadrature.html#PetscQuadrature">PetscQuadrature</a>  n;
<a name="line822">822: </a>  const <a href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> *points, *weights;
<a name="line823">823: </a>  <a href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a>        x[3];
<a name="line824">824: </a>  <a href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a>     *val;
<a name="line825">825: </a>  <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>         dim, dE, qNc, c, Nq, q;
<a name="line826">826: </a>  <a href="../../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a>        isAffine;
<a name="line827">827: </a>  <a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a>   ierr;

<a name="line832">832: </a>  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetDM.html#PetscDualSpaceGetDM">PetscDualSpaceGetDM</a>(sp, &amp;dm);
<a name="line833">833: </a>  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetFunctional.html#PetscDualSpaceGetFunctional">PetscDualSpaceGetFunctional</a>(sp, f, &amp;n);
<a name="line834">834: </a>  <a href="../../../../../docs/manualpages/DT/PetscQuadratureGetData.html#PetscQuadratureGetData">PetscQuadratureGetData</a>(n, &amp;dim, &amp;qNc, &amp;Nq, &amp;points, &amp;weights);
<a name="line835">835: </a>  <font color="#4169E1">if</font> (dim != cgeom-&gt;dim) <a href="../../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) sp), PETSC_ERR_ARG_SIZ, <font color="#666666">"The quadrature spatial dimension %D != cell geometry dimension %D"</font>, dim, cgeom-&gt;dim);
<a name="line836">836: </a>  <font color="#4169E1">if</font> (qNc != Nc) <a href="../../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) sp), PETSC_ERR_ARG_SIZ, <font color="#666666">"The quadrature components %D != function components %D"</font>, qNc, Nc);
<a name="line837">837: </a>  <a href="../../../../../docs/manualpages/DM/DMGetWorkArray.html#DMGetWorkArray">DMGetWorkArray</a>(dm, Nc, <a href="../../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</a>, &amp;val);
<a name="line838">838: </a>  *value = 0.0;
<a name="line839">839: </a>  isAffine = cgeom-&gt;isAffine;
<a name="line840">840: </a>  dE = cgeom-&gt;dimEmbed;
<a name="line841">841: </a>  <font color="#4169E1">for</font> (q = 0; q &lt; Nq; ++q) {
<a name="line842">842: </a>    <font color="#4169E1">if</font> (isAffine) {
<a name="line843">843: </a>      CoordinatesRefToReal(dE, cgeom-&gt;dim, cgeom-&gt;xi, cgeom-&gt;v, cgeom-&gt;J, &amp;points[q*dim], x);
<a name="line844">844: </a>      (*func)(dE, time, x, Nc, val, ctx);
<a name="line845">845: </a>    } <font color="#4169E1">else</font> {
<a name="line846">846: </a>      (*func)(dE, time, &amp;cgeom-&gt;v[dE*q], Nc, val, ctx);
<a name="line847">847: </a>    }
<a name="line848">848: </a>    <font color="#4169E1">for</font> (c = 0; c &lt; Nc; ++c) {
<a name="line849">849: </a>      *value += val[c]*weights[q*Nc+c];
<a name="line850">850: </a>    }
<a name="line851">851: </a>  }
<a name="line852">852: </a>  <a href="../../../../../docs/manualpages/DM/DMRestoreWorkArray.html#DMRestoreWorkArray">DMRestoreWorkArray</a>(dm, Nc, <a href="../../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</a>, &amp;val);
<a name="line853">853: </a>  <font color="#4169E1">return</font>(0);
<a name="line854">854: </a>}

<a name="line856">856: </a><font color="#B22222">/*@C</font>
<a name="line857">857: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceApplyAllDefault.html#PetscDualSpaceApplyAllDefault">PetscDualSpaceApplyAllDefault</a> - Apply all functionals from the dual space basis to the result of an evaluation at the points returned by <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetAllPoints.html#PetscDualSpaceGetAllPoints">PetscDualSpaceGetAllPoints</a>()</font>

<a name="line859">859: </a><font color="#B22222">  Input Parameters:</font>
<a name="line860">860: </a><font color="#B22222">+ sp        - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> object</font>
<a name="line861">861: </a><font color="#B22222">- pointEval - Evaluation at the points returned by <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetAllPoints.html#PetscDualSpaceGetAllPoints">PetscDualSpaceGetAllPoints</a>()</font>

<a name="line863">863: </a><font color="#B22222">  Output Parameter:</font>
<a name="line864">864: </a><font color="#B22222">. spValue   - The values of all dual space functionals</font>

<a name="line866">866: </a><font color="#B22222">  Level: beginner</font>

<a name="line868">868: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>()</font>
<a name="line869">869: </a><font color="#B22222">@*/</font>
<a name="line870">870: </a><strong><font color="#4169E1"><a name="PetscDualSpaceApplyAllDefault"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceApplyAllDefault.html#PetscDualSpaceApplyAllDefault">PetscDualSpaceApplyAllDefault</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, const <a href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> *pointEval, <a href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> *spValue)</font></strong>
<a name="line871">871: </a>{
<a name="line872">872: </a>  <a href="../../../../../docs/manualpages/FE/PetscQuadrature.html#PetscQuadrature">PetscQuadrature</a>  n;
<a name="line873">873: </a>  const <a href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> *points, *weights;
<a name="line874">874: </a>  <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>         qNc, c, Nq, q, f, spdim, Nc;
<a name="line875">875: </a>  <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>         offset;
<a name="line876">876: </a>  <a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a>   ierr;

<a name="line882">882: </a>  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetDimension.html#PetscDualSpaceGetDimension">PetscDualSpaceGetDimension</a>(sp, &amp;spdim);
<a name="line883">883: </a>  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetNumComponents.html#PetscDualSpaceGetNumComponents">PetscDualSpaceGetNumComponents</a>(sp, &amp;Nc);
<a name="line884">884: </a>  <font color="#4169E1">for</font> (f = 0, offset = 0; f &lt; spdim; f++) {
<a name="line885">885: </a>    <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetFunctional.html#PetscDualSpaceGetFunctional">PetscDualSpaceGetFunctional</a>(sp, f, &amp;n);
<a name="line886">886: </a>    <a href="../../../../../docs/manualpages/DT/PetscQuadratureGetData.html#PetscQuadratureGetData">PetscQuadratureGetData</a>(n, NULL, &amp;qNc, &amp;Nq, &amp;points, &amp;weights);
<a name="line887">887: </a>    <font color="#4169E1">if</font> (qNc != Nc) <a href="../../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) sp), PETSC_ERR_ARG_SIZ, <font color="#666666">"The quadrature components %D != function components %D"</font>, qNc, Nc);
<a name="line888">888: </a>    spValue[f] = 0.0;
<a name="line889">889: </a>    <font color="#4169E1">for</font> (q = 0; q &lt; Nq; ++q) {
<a name="line890">890: </a>      <font color="#4169E1">for</font> (c = 0; c &lt; Nc; ++c) {
<a name="line891">891: </a>        spValue[f] += pointEval[offset++]*weights[q*Nc+c];
<a name="line892">892: </a>      }
<a name="line893">893: </a>    }
<a name="line894">894: </a>  }
<a name="line895">895: </a>  <font color="#4169E1">return</font>(0);
<a name="line896">896: </a>}

<a name="line898">898: </a><font color="#B22222">/*@</font>
<a name="line899">899: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetAllPoints.html#PetscDualSpaceGetAllPoints">PetscDualSpaceGetAllPoints</a> - Get all quadrature points from this space</font>

<a name="line901">901: </a><font color="#B22222">  Input Parameter:</font>
<a name="line902">902: </a><font color="#B22222">. sp - The dualspace</font>

<a name="line904">904: </a><font color="#B22222">  Output Parameter:</font>
<a name="line905">905: </a><font color="#B22222">. allPoints - A <a href="../../../../../docs/manualpages/FE/PetscQuadrature.html#PetscQuadrature">PetscQuadrature</a> object containing all evaluation points</font>

<a name="line907">907: </a><font color="#B22222">  Level: advanced</font>

<a name="line909">909: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>()</font>
<a name="line910">910: </a><font color="#B22222">@*/</font>
<a name="line911">911: </a><strong><font color="#4169E1"><a name="PetscDualSpaceGetAllPoints"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetAllPoints.html#PetscDualSpaceGetAllPoints">PetscDualSpaceGetAllPoints</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, <a href="../../../../../docs/manualpages/FE/PetscQuadrature.html#PetscQuadrature">PetscQuadrature</a> *allPoints)</font></strong>
<a name="line912">912: </a>{

<a name="line918">918: </a>  <font color="#4169E1">if</font> (!sp-&gt;allPoints &amp;&amp; sp-&gt;ops-&gt;createallpoints) {
<a name="line919">919: </a>    (*sp-&gt;ops-&gt;createallpoints)(sp,&amp;sp-&gt;allPoints);
<a name="line920">920: </a>  }
<a name="line921">921: </a>  *allPoints = sp-&gt;allPoints;
<a name="line922">922: </a>  <font color="#4169E1">return</font>(0);
<a name="line923">923: </a>}

<a name="line925">925: </a><font color="#B22222">/*@</font>
<a name="line926">926: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreateAllPointsDefault.html#PetscDualSpaceCreateAllPointsDefault">PetscDualSpaceCreateAllPointsDefault</a> - Create all evaluation points by examining functionals</font>

<a name="line928">928: </a><font color="#B22222">  Input Parameter:</font>
<a name="line929">929: </a><font color="#B22222">. sp - The dualspace</font>

<a name="line931">931: </a><font color="#B22222">  Output Parameter:</font>
<a name="line932">932: </a><font color="#B22222">. allPoints - A <a href="../../../../../docs/manualpages/FE/PetscQuadrature.html#PetscQuadrature">PetscQuadrature</a> object containing all evaluation points</font>

<a name="line934">934: </a><font color="#B22222">  Level: advanced</font>

<a name="line936">936: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>()</font>
<a name="line937">937: </a><font color="#B22222">@*/</font>
<a name="line938">938: </a><strong><font color="#4169E1"><a name="PetscDualSpaceCreateAllPointsDefault"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreateAllPointsDefault.html#PetscDualSpaceCreateAllPointsDefault">PetscDualSpaceCreateAllPointsDefault</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, <a href="../../../../../docs/manualpages/FE/PetscQuadrature.html#PetscQuadrature">PetscQuadrature</a> *allPoints)</font></strong>
<a name="line939">939: </a>{
<a name="line940">940: </a>  <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>        spdim;
<a name="line941">941: </a>  <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>        numPoints, offset;
<a name="line942">942: </a>  <a href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a>       *points;
<a name="line943">943: </a>  <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>        f, dim;
<a name="line944">944: </a>  <a href="../../../../../docs/manualpages/FE/PetscQuadrature.html#PetscQuadrature">PetscQuadrature</a> q;
<a name="line945">945: </a>  <a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a>  ierr;

<a name="line948">948: </a>  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetDimension.html#PetscDualSpaceGetDimension">PetscDualSpaceGetDimension</a>(sp,&amp;spdim);
<a name="line949">949: </a>  <font color="#4169E1">if</font> (!spdim) {
<a name="line950">950: </a>    <a href="../../../../../docs/manualpages/DT/PetscQuadratureCreate.html#PetscQuadratureCreate">PetscQuadratureCreate</a>(<a href="../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>,allPoints);
<a name="line951">951: </a>    <a href="../../../../../docs/manualpages/DT/PetscQuadratureSetData.html#PetscQuadratureSetData">PetscQuadratureSetData</a>(*allPoints,0,0,0,NULL,NULL);
<a name="line952">952: </a>  }
<a name="line953">953: </a>  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetFunctional.html#PetscDualSpaceGetFunctional">PetscDualSpaceGetFunctional</a>(sp,0,&amp;q);
<a name="line954">954: </a>  <a href="../../../../../docs/manualpages/DT/PetscQuadratureGetData.html#PetscQuadratureGetData">PetscQuadratureGetData</a>(q,&amp;dim,NULL,&amp;numPoints,NULL,NULL);
<a name="line955">955: </a>  <font color="#4169E1">for</font> (f = 1; f &lt; spdim; f++) {
<a name="line956">956: </a>    <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Np;

<a name="line958">958: </a>    <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetFunctional.html#PetscDualSpaceGetFunctional">PetscDualSpaceGetFunctional</a>(sp,f,&amp;q);
<a name="line959">959: </a>    <a href="../../../../../docs/manualpages/DT/PetscQuadratureGetData.html#PetscQuadratureGetData">PetscQuadratureGetData</a>(q,NULL,NULL,&amp;Np,NULL,NULL);
<a name="line960">960: </a>    numPoints += Np;
<a name="line961">961: </a>  }
<a name="line962">962: </a>  <a href="../../../../../docs/manualpages/Sys/PetscMalloc1.html#PetscMalloc1">PetscMalloc1</a>(dim*numPoints,&amp;points);
<a name="line963">963: </a>  <font color="#4169E1">for</font> (f = 0, offset = 0; f &lt; spdim; f++) {
<a name="line964">964: </a>    const <a href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> *p;
<a name="line965">965: </a>    <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>        Np, i;

<a name="line967">967: </a>    <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetFunctional.html#PetscDualSpaceGetFunctional">PetscDualSpaceGetFunctional</a>(sp,f,&amp;q);
<a name="line968">968: </a>    <a href="../../../../../docs/manualpages/DT/PetscQuadratureGetData.html#PetscQuadratureGetData">PetscQuadratureGetData</a>(q,NULL,NULL,&amp;Np,&amp;p,NULL);
<a name="line969">969: </a>    <font color="#4169E1">for</font> (i = 0; i &lt; Np * dim; i++) {
<a name="line970">970: </a>      points[offset + i] = p[i];
<a name="line971">971: </a>    }
<a name="line972">972: </a>    offset += Np * dim;
<a name="line973">973: </a>  }
<a name="line974">974: </a>  <a href="../../../../../docs/manualpages/DT/PetscQuadratureCreate.html#PetscQuadratureCreate">PetscQuadratureCreate</a>(<a href="../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>,allPoints);
<a name="line975">975: </a>  <a href="../../../../../docs/manualpages/DT/PetscQuadratureSetData.html#PetscQuadratureSetData">PetscQuadratureSetData</a>(*allPoints,dim,0,numPoints,points,NULL);
<a name="line976">976: </a>  <font color="#4169E1">return</font>(0);
<a name="line977">977: </a>}

<a name="line979">979: </a><font color="#B22222">/*@C</font>
<a name="line980">980: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceApplyFVM.html#PetscDualSpaceApplyFVM">PetscDualSpaceApplyFVM</a> - Apply a functional from the dual space basis to an input function by assuming a point evaluation functional at the cell centroid.</font>

<a name="line982">982: </a><font color="#B22222">  Input Parameters:</font>
<a name="line983">983: </a><font color="#B22222">+ sp    - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> object</font>
<a name="line984">984: </a><font color="#B22222">. f     - The basis functional index</font>
<a name="line985">985: </a><font color="#B22222">. time  - The time</font>
<a name="line986">986: </a><font color="#B22222">. cgeom - A context with geometric information for this cell, we currently just use the centroid</font>
<a name="line987">987: </a><font color="#B22222">. Nc    - The number of components for the function</font>
<a name="line988">988: </a><font color="#B22222">. func  - The input function</font>
<a name="line989">989: </a><font color="#B22222">- ctx   - A context for the function</font>

<a name="line991">991: </a><font color="#B22222">  Output Parameter:</font>
<a name="line992">992: </a><font color="#B22222">. value - The output value (scalar)</font>

<a name="line994">994: </a><font color="#B22222">  Note: The calling sequence for the callback func is given by:</font>

<a name="line996">996: </a><font color="#B22222">$ func(<a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> time, const <a href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[],</font>
<a name="line997">997: </a><font color="#B22222">$      <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numComponents, <a href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> values[], void *ctx)</font>

<a name="line999">999: </a><font color="#B22222">and the idea is to evaluate the functional as an integral</font>

<a name="line1001">1001: </a><font color="#B22222">$ n(f) = int dx n(x) . f(x)</font>

<a name="line1003">1003: </a><font color="#B22222">where both n and f have Nc components.</font>

<a name="line1005">1005: </a><font color="#B22222">  Level: beginner</font>

<a name="line1007">1007: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceCreate.html#PetscDualSpaceCreate">PetscDualSpaceCreate</a>()</font>
<a name="line1008">1008: </a><font color="#B22222">@*/</font>
<a name="line1009">1009: </a><strong><font color="#4169E1"><a name="PetscDualSpaceApplyFVM"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceApplyFVM.html#PetscDualSpaceApplyFVM">PetscDualSpaceApplyFVM</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> time, <a href="../../../../../docs/manualpages/FV/PetscFVCellGeom.html#PetscFVCellGeom">PetscFVCellGeom</a> *cgeom, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nc, <a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> (*func)(<a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>, <a href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a>, const <a href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> [], <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>, <a href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> *, void *), void *ctx, <a href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> *value)</font></strong>
<a name="line1010">1010: </a>{
<a name="line1011">1011: </a>  <a href="../../../../../docs/manualpages/DM/DM.html#DM">DM</a>               dm;
<a name="line1012">1012: </a>  <a href="../../../../../docs/manualpages/FE/PetscQuadrature.html#PetscQuadrature">PetscQuadrature</a>  n;
<a name="line1013">1013: </a>  const <a href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> *points, *weights;
<a name="line1014">1014: </a>  <a href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a>     *val;
<a name="line1015">1015: </a>  <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>         dimEmbed, qNc, c, Nq, q;
<a name="line1016">1016: </a>  <a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a>   ierr;

<a name="line1021">1021: </a>  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetDM.html#PetscDualSpaceGetDM">PetscDualSpaceGetDM</a>(sp, &amp;dm);
<a name="line1022">1022: </a>  <a href="../../../../../docs/manualpages/DM/DMGetCoordinateDim.html#DMGetCoordinateDim">DMGetCoordinateDim</a>(dm, &amp;dimEmbed);
<a name="line1023">1023: </a>  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetFunctional.html#PetscDualSpaceGetFunctional">PetscDualSpaceGetFunctional</a>(sp, f, &amp;n);
<a name="line1024">1024: </a>  <a href="../../../../../docs/manualpages/DT/PetscQuadratureGetData.html#PetscQuadratureGetData">PetscQuadratureGetData</a>(n, NULL, &amp;qNc, &amp;Nq, &amp;points, &amp;weights);
<a name="line1025">1025: </a>  <font color="#4169E1">if</font> (qNc != Nc) <a href="../../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) sp), PETSC_ERR_ARG_SIZ, <font color="#666666">"The quadrature components %D != function components %D"</font>, qNc, Nc);
<a name="line1026">1026: </a>  <a href="../../../../../docs/manualpages/DM/DMGetWorkArray.html#DMGetWorkArray">DMGetWorkArray</a>(dm, Nc, <a href="../../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</a>, &amp;val);
<a name="line1027">1027: </a>  *value = 0.;
<a name="line1028">1028: </a>  <font color="#4169E1">for</font> (q = 0; q &lt; Nq; ++q) {
<a name="line1029">1029: </a>    (*func)(dimEmbed, time, cgeom-&gt;centroid, Nc, val, ctx);
<a name="line1030">1030: </a>    <font color="#4169E1">for</font> (c = 0; c &lt; Nc; ++c) {
<a name="line1031">1031: </a>      *value += val[c]*weights[q*Nc+c];
<a name="line1032">1032: </a>    }
<a name="line1033">1033: </a>  }
<a name="line1034">1034: </a>  <a href="../../../../../docs/manualpages/DM/DMRestoreWorkArray.html#DMRestoreWorkArray">DMRestoreWorkArray</a>(dm, Nc, <a href="../../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</a>, &amp;val);
<a name="line1035">1035: </a>  <font color="#4169E1">return</font>(0);
<a name="line1036">1036: </a>}

<a name="line1038">1038: </a><font color="#B22222">/*@</font>
<a name="line1039">1039: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetHeightSubspace.html#PetscDualSpaceGetHeightSubspace">PetscDualSpaceGetHeightSubspace</a> - Get the subset of the dual space basis that is supported on a mesh point of a</font>
<a name="line1040">1040: </a><font color="#B22222">  given height.  This assumes that the reference cell is symmetric over points of this height.</font>

<a name="line1042">1042: </a><font color="#B22222">  If the dual space is not defined on mesh points of the given height (e.g. if the space is discontinuous and</font>
<a name="line1043">1043: </a><font color="#B22222">  pointwise values are not defined on the element boundaries), or if the implementation of <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> does not</font>
<a name="line1044">1044: </a><font color="#B22222">  support extracting subspaces, then NULL is returned.</font>

<a name="line1046">1046: </a><font color="#B22222">  This does not increment the reference count on the returned dual space, and the user should not destroy it.</font>

<a name="line1048">1048: </a><font color="#B22222">  Not collective</font>

<a name="line1050">1050: </a><font color="#B22222">  Input Parameters:</font>
<a name="line1051">1051: </a><font color="#B22222">+ sp - the <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> object</font>
<a name="line1052">1052: </a><font color="#B22222">- height - the height of the mesh point for which the subspace is desired</font>

<a name="line1054">1054: </a><font color="#B22222">  Output Parameter:</font>
<a name="line1055">1055: </a><font color="#B22222">. subsp - the subspace.  Note that the functionals in the subspace are with respect to the intrinsic geometry of the</font>
<a name="line1056">1056: </a><font color="#B22222">  point, which will be of lesser dimension if height &gt; 0.</font>

<a name="line1058">1058: </a><font color="#B22222">  Level: advanced</font>

<a name="line1060">1060: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/SPACE/PetscSpaceGetHeightSubspace.html#PetscSpaceGetHeightSubspace">PetscSpaceGetHeightSubspace</a>(), <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>
<a name="line1061">1061: </a><font color="#B22222">@*/</font>
<a name="line1062">1062: </a><strong><font color="#4169E1"><a name="PetscDualSpaceGetHeightSubspace"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetHeightSubspace.html#PetscDualSpaceGetHeightSubspace">PetscDualSpaceGetHeightSubspace</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> height, <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> *subsp)</font></strong>
<a name="line1063">1063: </a>{

<a name="line1069">1069: </a>  *subsp = NULL;
<a name="line1070">1070: </a>  <font color="#4169E1">if</font> (sp-&gt;ops-&gt;getheightsubspace) {(*sp-&gt;ops-&gt;getheightsubspace)(sp, height, subsp);}
<a name="line1071">1071: </a>  <font color="#4169E1">return</font>(0);
<a name="line1072">1072: </a>}

<a name="line1074">1074: </a><font color="#B22222">/*@</font>
<a name="line1075">1075: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetPointSubspace.html#PetscDualSpaceGetPointSubspace">PetscDualSpaceGetPointSubspace</a> - Get the subset of the dual space basis that is supported on a particular mesh point.</font>

<a name="line1077">1077: </a><font color="#B22222">  If the dual space is not defined on the mesh point (e.g. if the space is discontinuous and pointwise values are not</font>
<a name="line1078">1078: </a><font color="#B22222">  defined on the element boundaries), or if the implementation of <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> does not support extracting</font>
<a name="line1079">1079: </a><font color="#B22222">  subspaces, then NULL is returned.</font>

<a name="line1081">1081: </a><font color="#B22222">  This does not increment the reference count on the returned dual space, and the user should not destroy it.</font>

<a name="line1083">1083: </a><font color="#B22222">  Not collective</font>

<a name="line1085">1085: </a><font color="#B22222">  Input Parameters:</font>
<a name="line1086">1086: </a><font color="#B22222">+ sp - the <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> object</font>
<a name="line1087">1087: </a><font color="#B22222">- point - the point (in the dual space's <a href="../../../../../docs/manualpages/DM/DM.html#DM">DM</a>) for which the subspace is desired</font>

<a name="line1089">1089: </a><font color="#B22222">  Output Parameters:</font>
<a name="line1090">1090: </a><font color="#B22222">  bdsp - the subspace.  Note that the functionals in the subspace are with respect to the intrinsic geometry of the</font>
<a name="line1091">1091: </a><font color="#B22222">  point, which will be of lesser dimension if height &gt; 0.</font>

<a name="line1093">1093: </a><font color="#B22222">  Level: advanced</font>

<a name="line1095">1095: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>
<a name="line1096">1096: </a><font color="#B22222">@*/</font>
<a name="line1097">1097: </a><strong><font color="#4169E1"><a name="PetscDualSpaceGetPointSubspace"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetPointSubspace.html#PetscDualSpaceGetPointSubspace">PetscDualSpaceGetPointSubspace</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> point, <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> *bdsp)</font></strong>
<a name="line1098">1098: </a>{

<a name="line1104">1104: </a>  *bdsp = NULL;
<a name="line1105">1105: </a>  <font color="#4169E1">if</font> (sp-&gt;ops-&gt;getpointsubspace) {
<a name="line1106">1106: </a>    (*sp-&gt;ops-&gt;getpointsubspace)(sp,point,bdsp);
<a name="line1107">1107: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (sp-&gt;ops-&gt;getheightsubspace) {
<a name="line1108">1108: </a>    <a href="../../../../../docs/manualpages/DM/DM.html#DM">DM</a>       dm;
<a name="line1109">1109: </a>    <a href="../../../../../docs/manualpages/DM/DMLabel.html#DMLabel">DMLabel</a>  label;
<a name="line1110">1110: </a>    <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, depth, height;

<a name="line1112">1112: </a>    <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetDM.html#PetscDualSpaceGetDM">PetscDualSpaceGetDM</a>(sp,&amp;dm);
<a name="line1113">1113: </a>    <a href="../../../../../docs/manualpages/DMPLEX/DMPlexGetDepth.html#DMPlexGetDepth">DMPlexGetDepth</a>(dm,&amp;dim);
<a name="line1114">1114: </a>    <a href="../../../../../docs/manualpages/DMPLEX/DMPlexGetDepthLabel.html#DMPlexGetDepthLabel">DMPlexGetDepthLabel</a>(dm,&amp;label);
<a name="line1115">1115: </a>    <a href="../../../../../docs/manualpages/DMLABEL/DMLabelGetValue.html#DMLabelGetValue">DMLabelGetValue</a>(label,point,&amp;depth);
<a name="line1116">1116: </a>    height = dim - depth;
<a name="line1117">1117: </a>    (*sp-&gt;ops-&gt;getheightsubspace)(sp,height,bdsp);
<a name="line1118">1118: </a>  }
<a name="line1119">1119: </a>  <font color="#4169E1">return</font>(0);
<a name="line1120">1120: </a>}

<a name="line1122">1122: </a><font color="#B22222">/*@C</font>
<a name="line1123">1123: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetSymmetries.html#PetscDualSpaceGetSymmetries">PetscDualSpaceGetSymmetries</a> - Returns a description of the symmetries of this basis</font>

<a name="line1125">1125: </a><font color="#B22222">  Not collective</font>

<a name="line1127">1127: </a><font color="#B22222">  Input Parameter:</font>
<a name="line1128">1128: </a><font color="#B22222">. sp - the <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> object</font>

<a name="line1130">1130: </a><font color="#B22222">  Output Parameters:</font>
<a name="line1131">1131: </a><font color="#B22222">+ perms - Permutations of the local degrees of freedom, parameterized by the point orientation</font>
<a name="line1132">1132: </a><font color="#B22222">- flips - Sign reversal of the local degrees of freedom, parameterized by the point orientation</font>

<a name="line1134">1134: </a><font color="#B22222">  Note: The permutation and flip arrays are organized in the following way</font>
<a name="line1135">1135: </a><font color="#B22222">$ perms[p][ornt][dof # on point] = new local dof #</font>
<a name="line1136">1136: </a><font color="#B22222">$ flips[p][ornt][dof # on point] = reversal or not</font>

<a name="line1138">1138: </a><font color="#B22222">  Level: developer</font>

<a name="line1140">1140: </a><font color="#B22222">.seealso: PetscDualSpaceSetSymmetries()</font>
<a name="line1141">1141: </a><font color="#B22222">@*/</font>
<a name="line1142">1142: </a><strong><font color="#4169E1"><a name="PetscDualSpaceGetSymmetries"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetSymmetries.html#PetscDualSpaceGetSymmetries">PetscDualSpaceGetSymmetries</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> sp, const <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> ****perms, const <a href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> ****flips)</font></strong>
<a name="line1143">1143: </a>{

<a name="line1150">1150: </a>  <font color="#4169E1">if</font> (sp-&gt;ops-&gt;getsymmetries) {(sp-&gt;ops-&gt;getsymmetries)(sp,perms,flips);}
<a name="line1151">1151: </a>  <font color="#4169E1">return</font>(0);
<a name="line1152">1152: </a>}

<a name="line1154">1154: </a><font color="#B22222">/*@</font>
<a name="line1155">1155: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetDeRahm.html#PetscDualSpaceGetDeRahm">PetscDualSpaceGetDeRahm</a> - Get the k-simplex associated with the functionals in this dual space</font>

<a name="line1157">1157: </a><font color="#B22222">  Input Parameter:</font>
<a name="line1158">1158: </a><font color="#B22222">. dsp - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>

<a name="line1160">1160: </a><font color="#B22222">  Output Parameter:</font>
<a name="line1161">1161: </a><font color="#B22222">. k   - The simplex dimension</font>

<a name="line1163">1163: </a><font color="#B22222">  Level: developer</font>

<a name="line1165">1165: </a><font color="#B22222">  Note: Currently supported values are</font>
<a name="line1166">1166: </a><font color="#B22222">$ 0: These are H_1 methods that only transform coordinates</font>
<a name="line1167">1167: </a><font color="#B22222">$ 1: These are Hcurl methods that transform functions using the covariant Piola transform (COVARIANT_PIOLA_TRANSFORM)</font>
<a name="line1168">1168: </a><font color="#B22222">$ 2: These are the same as 1</font>
<a name="line1169">1169: </a><font color="#B22222">$ 3: These are Hdiv methods that transform functions using the contravariant Piola transform (CONTRAVARIANT_PIOLA_TRANSFORM)</font>

<a name="line1171">1171: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpacePullback.html#PetscDualSpacePullback">PetscDualSpacePullback</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpacePushforward.html#PetscDualSpacePushforward">PetscDualSpacePushforward</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceTransform.html#PetscDualSpaceTransform">PetscDualSpaceTransform</a>(), <a href="../../../../../docs/manualpages/FE/PetscDualSpaceTransformType.html#PetscDualSpaceTransformType">PetscDualSpaceTransformType</a></font>
<a name="line1172">1172: </a><font color="#B22222">@*/</font>
<a name="line1173">1173: </a><strong><font color="#4169E1"><a name="PetscDualSpaceGetDeRahm"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetDeRahm.html#PetscDualSpaceGetDeRahm">PetscDualSpaceGetDeRahm</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> dsp, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *k)</font></strong>
<a name="line1174">1174: </a>{
<a name="line1178">1178: </a>  *k = dsp-&gt;k;
<a name="line1179">1179: </a>  <font color="#4169E1">return</font>(0);
<a name="line1180">1180: </a>}

<a name="line1182">1182: </a><font color="#B22222">/*@C</font>
<a name="line1183">1183: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceTransform.html#PetscDualSpaceTransform">PetscDualSpaceTransform</a> - Transform the function values</font>

<a name="line1185">1185: </a><font color="#B22222">  Input Parameters:</font>
<a name="line1186">1186: </a><font color="#B22222">+ dsp       - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>
<a name="line1187">1187: </a><font color="#B22222">. trans     - The type of transform</font>
<a name="line1188">1188: </a><font color="#B22222">. isInverse - Flag to invert the transform</font>
<a name="line1189">1189: </a><font color="#B22222">. fegeom    - The cell geometry</font>
<a name="line1190">1190: </a><font color="#B22222">. Nv        - The number of function samples</font>
<a name="line1191">1191: </a><font color="#B22222">. Nc        - The number of function components</font>
<a name="line1192">1192: </a><font color="#B22222">- vals      - The function values</font>

<a name="line1194">1194: </a><font color="#B22222">  Output Parameter:</font>
<a name="line1195">1195: </a><font color="#B22222">. vals      - The transformed function values</font>

<a name="line1197">1197: </a><font color="#B22222">  Level: intermediate</font>

<a name="line1199">1199: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceTransformGradient.html#PetscDualSpaceTransformGradient">PetscDualSpaceTransformGradient</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpacePullback.html#PetscDualSpacePullback">PetscDualSpacePullback</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpacePushforward.html#PetscDualSpacePushforward">PetscDualSpacePushforward</a>(), <a href="../../../../../docs/manualpages/FE/PetscDualSpaceTransformType.html#PetscDualSpaceTransformType">PetscDualSpaceTransformType</a></font>
<a name="line1200">1200: </a><font color="#B22222">@*/</font>
<a name="line1201">1201: </a><strong><font color="#4169E1"><a name="PetscDualSpaceTransform"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceTransform.html#PetscDualSpaceTransform">PetscDualSpaceTransform</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> dsp, <a href="../../../../../docs/manualpages/FE/PetscDualSpaceTransformType.html#PetscDualSpaceTransformType">PetscDualSpaceTransformType</a> trans, <a href="../../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a> isInverse, PetscFEGeom *fegeom, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nv, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nc, <a href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> vals[])</font></strong>
<a name="line1202">1202: </a>{
<a name="line1203">1203: </a>  <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, v, c;

<a name="line1209">1209: </a>  dim = dsp-&gt;dm-&gt;dim;
<a name="line1210">1210: </a>  <font color="#B22222">/* Assume its a vector, otherwise assume its a bunch of scalars */</font>
<a name="line1211">1211: </a>  <font color="#4169E1">if</font> (Nc == 1 || Nc != dim) <font color="#4169E1">return</font>(0);
<a name="line1212">1212: </a>  <font color="#4169E1">switch</font> (trans) {
<a name="line1213">1213: </a>    <font color="#4169E1">case</font> IDENTITY_TRANSFORM: <font color="#4169E1">break</font>;
<a name="line1214">1214: </a>    <font color="#4169E1">case</font> COVARIANT_PIOLA_TRANSFORM: <font color="#B22222">/* Covariant Piola mapping $\sigma^*(F) = J^{-T} F \circ \phi^{-1)$ */</font>
<a name="line1215">1215: </a>    <font color="#4169E1">if</font> (isInverse) {
<a name="line1216">1216: </a>      <font color="#4169E1">for</font> (v = 0; v &lt; Nv; ++v) {
<a name="line1217">1217: </a>        <font color="#4169E1">switch</font> (dim)
<a name="line1218">1218: </a>        {
<a name="line1219">1219: </a>          <font color="#4169E1">case</font> 2: DMPlex_MultTranspose2DReal_Internal(fegeom-&gt;J, 1, &amp;vals[v*Nc], &amp;vals[v*Nc]);<font color="#4169E1">break</font>;
<a name="line1220">1220: </a>          <font color="#4169E1">case</font> 3: DMPlex_MultTranspose3DReal_Internal(fegeom-&gt;J, 1, &amp;vals[v*Nc], &amp;vals[v*Nc]);<font color="#4169E1">break</font>;
<a name="line1221">1221: </a><strong><font color="#FF0000">          default:</font></strong> <a href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) dsp), PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Unsupported dim %D for transformation"</font>, dim);
<a name="line1222">1222: </a>        }
<a name="line1223">1223: </a>      }
<a name="line1224">1224: </a>    } <font color="#4169E1">else</font> {
<a name="line1225">1225: </a>      <font color="#4169E1">for</font> (v = 0; v &lt; Nv; ++v) {
<a name="line1226">1226: </a>        <font color="#4169E1">switch</font> (dim)
<a name="line1227">1227: </a>        {
<a name="line1228">1228: </a>          <font color="#4169E1">case</font> 2: DMPlex_MultTranspose2DReal_Internal(fegeom-&gt;invJ, 1, &amp;vals[v*Nc], &amp;vals[v*Nc]);<font color="#4169E1">break</font>;
<a name="line1229">1229: </a>          <font color="#4169E1">case</font> 3: DMPlex_MultTranspose3DReal_Internal(fegeom-&gt;invJ, 1, &amp;vals[v*Nc], &amp;vals[v*Nc]);<font color="#4169E1">break</font>;
<a name="line1230">1230: </a><strong><font color="#FF0000">          default:</font></strong> <a href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) dsp), PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Unsupported dim %D for transformation"</font>, dim);
<a name="line1231">1231: </a>        }
<a name="line1232">1232: </a>      }
<a name="line1233">1233: </a>    }
<a name="line1234">1234: </a>    <font color="#4169E1">break</font>;
<a name="line1235">1235: </a>    <font color="#4169E1">case</font> CONTRAVARIANT_PIOLA_TRANSFORM: <font color="#B22222">/* Contravariant Piola mapping $\sigma^*(F) = \frac{1}{|\det J|} J F \circ \phi^{-1}$ */</font>
<a name="line1236">1236: </a>    <font color="#4169E1">if</font> (isInverse) {
<a name="line1237">1237: </a>      <font color="#4169E1">for</font> (v = 0; v &lt; Nv; ++v) {
<a name="line1238">1238: </a>        <font color="#4169E1">switch</font> (dim)
<a name="line1239">1239: </a>        {
<a name="line1240">1240: </a>          <font color="#4169E1">case</font> 2: DMPlex_Mult2DReal_Internal(fegeom-&gt;invJ, 1, &amp;vals[v*Nc], &amp;vals[v*Nc]);<font color="#4169E1">break</font>;
<a name="line1241">1241: </a>          <font color="#4169E1">case</font> 3: DMPlex_Mult3DReal_Internal(fegeom-&gt;invJ, 1, &amp;vals[v*Nc], &amp;vals[v*Nc]);<font color="#4169E1">break</font>;
<a name="line1242">1242: </a><strong><font color="#FF0000">          default:</font></strong> <a href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) dsp), PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Unsupported dim %D for transformation"</font>, dim);
<a name="line1243">1243: </a>        }
<a name="line1244">1244: </a>        <font color="#4169E1">for</font> (c = 0; c &lt; Nc; ++c) vals[v*Nc+c] *= fegeom-&gt;detJ[0];
<a name="line1245">1245: </a>      }
<a name="line1246">1246: </a>    } <font color="#4169E1">else</font> {
<a name="line1247">1247: </a>      <font color="#4169E1">for</font> (v = 0; v &lt; Nv; ++v) {
<a name="line1248">1248: </a>        <font color="#4169E1">switch</font> (dim)
<a name="line1249">1249: </a>        {
<a name="line1250">1250: </a>          <font color="#4169E1">case</font> 2: DMPlex_Mult2DReal_Internal(fegeom-&gt;J, 1, &amp;vals[v*Nc], &amp;vals[v*Nc]);<font color="#4169E1">break</font>;
<a name="line1251">1251: </a>          <font color="#4169E1">case</font> 3: DMPlex_Mult3DReal_Internal(fegeom-&gt;J, 1, &amp;vals[v*Nc], &amp;vals[v*Nc]);<font color="#4169E1">break</font>;
<a name="line1252">1252: </a><strong><font color="#FF0000">          default:</font></strong> <a href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) dsp), PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Unsupported dim %D for transformation"</font>, dim);
<a name="line1253">1253: </a>        }
<a name="line1254">1254: </a>        <font color="#4169E1">for</font> (c = 0; c &lt; Nc; ++c) vals[v*Nc+c] /= fegeom-&gt;detJ[0];
<a name="line1255">1255: </a>      }
<a name="line1256">1256: </a>    }
<a name="line1257">1257: </a>    <font color="#4169E1">break</font>;
<a name="line1258">1258: </a>  }
<a name="line1259">1259: </a>  <font color="#4169E1">return</font>(0);
<a name="line1260">1260: </a>}
<a name="line1261">1261: </a><font color="#B22222">/*@C</font>
<a name="line1262">1262: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceTransformGradient.html#PetscDualSpaceTransformGradient">PetscDualSpaceTransformGradient</a> - Transform the function gradient values</font>

<a name="line1264">1264: </a><font color="#B22222">  Input Parameters:</font>
<a name="line1265">1265: </a><font color="#B22222">+ dsp       - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>
<a name="line1266">1266: </a><font color="#B22222">. trans     - The type of transform</font>
<a name="line1267">1267: </a><font color="#B22222">. isInverse - Flag to invert the transform</font>
<a name="line1268">1268: </a><font color="#B22222">. fegeom    - The cell geometry</font>
<a name="line1269">1269: </a><font color="#B22222">. Nv        - The number of function gradient samples</font>
<a name="line1270">1270: </a><font color="#B22222">. Nc        - The number of function components</font>
<a name="line1271">1271: </a><font color="#B22222">- vals      - The function gradient values</font>

<a name="line1273">1273: </a><font color="#B22222">  Output Parameter:</font>
<a name="line1274">1274: </a><font color="#B22222">. vals      - The transformed function values</font>

<a name="line1276">1276: </a><font color="#B22222">  Level: intermediate</font>

<a name="line1278">1278: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceTransform.html#PetscDualSpaceTransform">PetscDualSpaceTransform</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpacePullback.html#PetscDualSpacePullback">PetscDualSpacePullback</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpacePushforward.html#PetscDualSpacePushforward">PetscDualSpacePushforward</a>(), <a href="../../../../../docs/manualpages/FE/PetscDualSpaceTransformType.html#PetscDualSpaceTransformType">PetscDualSpaceTransformType</a></font>
<a name="line1279">1279: </a><font color="#B22222">@*/</font>
<a name="line1280">1280: </a><strong><font color="#4169E1"><a name="PetscDualSpaceTransformGradient"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceTransformGradient.html#PetscDualSpaceTransformGradient">PetscDualSpaceTransformGradient</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> dsp, <a href="../../../../../docs/manualpages/FE/PetscDualSpaceTransformType.html#PetscDualSpaceTransformType">PetscDualSpaceTransformType</a> trans, <a href="../../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a> isInverse, PetscFEGeom *fegeom, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nv, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nc, <a href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> vals[])</font></strong>
<a name="line1281">1281: </a>{
<a name="line1282">1282: </a>  <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, v, c, d;

<a name="line1288">1288: </a>  dim = dsp-&gt;dm-&gt;dim;
<a name="line1289">1289: </a>  <font color="#B22222">/* Transform gradient */</font>
<a name="line1290">1290: </a>  <font color="#4169E1">for</font> (v = 0; v &lt; Nv; ++v) {
<a name="line1291">1291: </a>    <font color="#4169E1">for</font> (c = 0; c &lt; Nc; ++c) {
<a name="line1292">1292: </a>      <font color="#4169E1">switch</font> (dim)
<a name="line1293">1293: </a>      {
<a name="line1294">1294: </a>        <font color="#4169E1">case</font> 1: vals[(v*Nc+c)*dim] *= fegeom-&gt;invJ[0];
<a name="line1295">1295: </a>        <font color="#4169E1">case</font> 2: DMPlex_MultTranspose2DReal_Internal(fegeom-&gt;invJ, 1, &amp;vals[(v*Nc+c)*dim], &amp;vals[(v*Nc+c)*dim]);<font color="#4169E1">break</font>;
<a name="line1296">1296: </a>        <font color="#4169E1">case</font> 3: DMPlex_MultTranspose3DReal_Internal(fegeom-&gt;invJ, 1, &amp;vals[(v*Nc+c)*dim], &amp;vals[(v*Nc+c)*dim]);<font color="#4169E1">break</font>;
<a name="line1297">1297: </a><strong><font color="#FF0000">        default:</font></strong> <a href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) dsp), PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Unsupported dim %D for transformation"</font>, dim);
<a name="line1298">1298: </a>      }
<a name="line1299">1299: </a>    }
<a name="line1300">1300: </a>  }
<a name="line1301">1301: </a>  <font color="#B22222">/* Assume its a vector, otherwise assume its a bunch of scalars */</font>
<a name="line1302">1302: </a>  <font color="#4169E1">if</font> (Nc == 1 || Nc != dim) <font color="#4169E1">return</font>(0);
<a name="line1303">1303: </a>  <font color="#4169E1">switch</font> (trans) {
<a name="line1304">1304: </a>    <font color="#4169E1">case</font> IDENTITY_TRANSFORM: <font color="#4169E1">break</font>;
<a name="line1305">1305: </a>    <font color="#4169E1">case</font> COVARIANT_PIOLA_TRANSFORM: <font color="#B22222">/* Covariant Piola mapping $\sigma^*(F) = J^{-T} F \circ \phi^{-1)$ */</font>
<a name="line1306">1306: </a>    <font color="#4169E1">if</font> (isInverse) {
<a name="line1307">1307: </a>      <font color="#4169E1">for</font> (v = 0; v &lt; Nv; ++v) {
<a name="line1308">1308: </a>        <font color="#4169E1">for</font> (d = 0; d &lt; dim; ++d) {
<a name="line1309">1309: </a>          <font color="#4169E1">switch</font> (dim)
<a name="line1310">1310: </a>          {
<a name="line1311">1311: </a>            <font color="#4169E1">case</font> 2: DMPlex_MultTranspose2DReal_Internal(fegeom-&gt;J, dim, &amp;vals[v*Nc*dim+d], &amp;vals[v*Nc*dim+d]);<font color="#4169E1">break</font>;
<a name="line1312">1312: </a>            <font color="#4169E1">case</font> 3: DMPlex_MultTranspose3DReal_Internal(fegeom-&gt;J, dim, &amp;vals[v*Nc*dim+d], &amp;vals[v*Nc*dim+d]);<font color="#4169E1">break</font>;
<a name="line1313">1313: </a><strong><font color="#FF0000">            default:</font></strong> <a href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) dsp), PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Unsupported dim %D for transformation"</font>, dim);
<a name="line1314">1314: </a>          }
<a name="line1315">1315: </a>        }
<a name="line1316">1316: </a>      }
<a name="line1317">1317: </a>    } <font color="#4169E1">else</font> {
<a name="line1318">1318: </a>      <font color="#4169E1">for</font> (v = 0; v &lt; Nv; ++v) {
<a name="line1319">1319: </a>        <font color="#4169E1">for</font> (d = 0; d &lt; dim; ++d) {
<a name="line1320">1320: </a>          <font color="#4169E1">switch</font> (dim)
<a name="line1321">1321: </a>          {
<a name="line1322">1322: </a>            <font color="#4169E1">case</font> 2: DMPlex_MultTranspose2DReal_Internal(fegeom-&gt;invJ, dim, &amp;vals[v*Nc*dim+d], &amp;vals[v*Nc*dim+d]);<font color="#4169E1">break</font>;
<a name="line1323">1323: </a>            <font color="#4169E1">case</font> 3: DMPlex_MultTranspose3DReal_Internal(fegeom-&gt;invJ, dim, &amp;vals[v*Nc*dim+d], &amp;vals[v*Nc*dim+d]);<font color="#4169E1">break</font>;
<a name="line1324">1324: </a><strong><font color="#FF0000">            default:</font></strong> <a href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) dsp), PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Unsupported dim %D for transformation"</font>, dim);
<a name="line1325">1325: </a>          }
<a name="line1326">1326: </a>        }
<a name="line1327">1327: </a>      }
<a name="line1328">1328: </a>    }
<a name="line1329">1329: </a>    <font color="#4169E1">break</font>;
<a name="line1330">1330: </a>    <font color="#4169E1">case</font> CONTRAVARIANT_PIOLA_TRANSFORM: <font color="#B22222">/* Contravariant Piola mapping $\sigma^*(F) = \frac{1}{|\det J|} J F \circ \phi^{-1}$ */</font>
<a name="line1331">1331: </a>    <font color="#4169E1">if</font> (isInverse) {
<a name="line1332">1332: </a>      <font color="#4169E1">for</font> (v = 0; v &lt; Nv; ++v) {
<a name="line1333">1333: </a>        <font color="#4169E1">for</font> (d = 0; d &lt; dim; ++d) {
<a name="line1334">1334: </a>          <font color="#4169E1">switch</font> (dim)
<a name="line1335">1335: </a>          {
<a name="line1336">1336: </a>            <font color="#4169E1">case</font> 2: DMPlex_Mult2DReal_Internal(fegeom-&gt;invJ, dim, &amp;vals[v*Nc*dim+d], &amp;vals[v*Nc*dim+d]);<font color="#4169E1">break</font>;
<a name="line1337">1337: </a>            <font color="#4169E1">case</font> 3: DMPlex_Mult3DReal_Internal(fegeom-&gt;invJ, dim, &amp;vals[v*Nc*dim+d], &amp;vals[v*Nc*dim+d]);<font color="#4169E1">break</font>;
<a name="line1338">1338: </a><strong><font color="#FF0000">            default:</font></strong> <a href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) dsp), PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Unsupported dim %D for transformation"</font>, dim);
<a name="line1339">1339: </a>          }
<a name="line1340">1340: </a>          <font color="#4169E1">for</font> (c = 0; c &lt; Nc; ++c) vals[(v*Nc+c)*dim+d] *= fegeom-&gt;detJ[0];
<a name="line1341">1341: </a>        }
<a name="line1342">1342: </a>      }
<a name="line1343">1343: </a>    } <font color="#4169E1">else</font> {
<a name="line1344">1344: </a>      <font color="#4169E1">for</font> (v = 0; v &lt; Nv; ++v) {
<a name="line1345">1345: </a>        <font color="#4169E1">for</font> (d = 0; d &lt; dim; ++d) {
<a name="line1346">1346: </a>          <font color="#4169E1">switch</font> (dim)
<a name="line1347">1347: </a>          {
<a name="line1348">1348: </a>            <font color="#4169E1">case</font> 2: DMPlex_Mult2DReal_Internal(fegeom-&gt;J, dim, &amp;vals[v*Nc*dim+d], &amp;vals[v*Nc*dim+d]);<font color="#4169E1">break</font>;
<a name="line1349">1349: </a>            <font color="#4169E1">case</font> 3: DMPlex_Mult3DReal_Internal(fegeom-&gt;J, dim, &amp;vals[v*Nc*dim+d], &amp;vals[v*Nc*dim+d]);<font color="#4169E1">break</font>;
<a name="line1350">1350: </a><strong><font color="#FF0000">            default:</font></strong> <a href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) dsp), PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Unsupported dim %D for transformation"</font>, dim);
<a name="line1351">1351: </a>          }
<a name="line1352">1352: </a>          <font color="#4169E1">for</font> (c = 0; c &lt; Nc; ++c) vals[(v*Nc+c)*dim+d] /= fegeom-&gt;detJ[0];
<a name="line1353">1353: </a>        }
<a name="line1354">1354: </a>      }
<a name="line1355">1355: </a>    }
<a name="line1356">1356: </a>    <font color="#4169E1">break</font>;
<a name="line1357">1357: </a>  }
<a name="line1358">1358: </a>  <font color="#4169E1">return</font>(0);
<a name="line1359">1359: </a>}

<a name="line1361">1361: </a><font color="#B22222">/*@C</font>
<a name="line1362">1362: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpacePullback.html#PetscDualSpacePullback">PetscDualSpacePullback</a> - Transform the given functional so that it operates on real space, rather than the reference element. Operationally, this means that we map the function evaluations depending on continuity requirements of our finite element method.</font>

<a name="line1364">1364: </a><font color="#B22222">  Input Parameters:</font>
<a name="line1365">1365: </a><font color="#B22222">+ dsp        - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>
<a name="line1366">1366: </a><font color="#B22222">. fegeom     - The geometry for this cell</font>
<a name="line1367">1367: </a><font color="#B22222">. Nq         - The number of function samples</font>
<a name="line1368">1368: </a><font color="#B22222">. Nc         - The number of function components</font>
<a name="line1369">1369: </a><font color="#B22222">- pointEval  - The function values</font>

<a name="line1371">1371: </a><font color="#B22222">  Output Parameter:</font>
<a name="line1372">1372: </a><font color="#B22222">. pointEval  - The transformed function values</font>

<a name="line1374">1374: </a><font color="#B22222">  Level: advanced</font>

<a name="line1376">1376: </a><font color="#B22222">  Note: Functions transform in a complementary way (pushforward) to functionals, so that the scalar product is invariant. The type of transform is dependent on the associated k-simplex from the DeRahm complex.</font>

<a name="line1378">1378: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpacePushforward.html#PetscDualSpacePushforward">PetscDualSpacePushforward</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceTransform.html#PetscDualSpaceTransform">PetscDualSpaceTransform</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetDeRahm.html#PetscDualSpaceGetDeRahm">PetscDualSpaceGetDeRahm</a>()</font>
<a name="line1379">1379: </a><font color="#B22222">@*/</font>
<a name="line1380">1380: </a><strong><font color="#4169E1"><a name="PetscDualSpacePullback"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpacePullback.html#PetscDualSpacePullback">PetscDualSpacePullback</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> dsp, PetscFEGeom *fegeom, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nq, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nc, <a href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> pointEval[])</font></strong>
<a name="line1381">1381: </a>{
<a name="line1382">1382: </a>  <a href="../../../../../docs/manualpages/FE/PetscDualSpaceTransformType.html#PetscDualSpaceTransformType">PetscDualSpaceTransformType</a> trans;
<a name="line1383">1383: </a>  <a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a>              ierr;

<a name="line1389">1389: </a>  <font color="#B22222">/* The dualspace dofs correspond to some simplex in the DeRahm complex, which we label by k.</font>
<a name="line1390">1390: </a><font color="#B22222">     This determines their transformation properties. */</font>
<a name="line1391">1391: </a>  <font color="#4169E1">switch</font> (dsp-&gt;k)
<a name="line1392">1392: </a>  {
<a name="line1393">1393: </a>    <font color="#4169E1">case</font> 0: <font color="#B22222">/* H^1 point evaluations */</font>
<a name="line1394">1394: </a>    trans = IDENTITY_TRANSFORM;<font color="#4169E1">break</font>;
<a name="line1395">1395: </a>    <font color="#4169E1">case</font> 1: <font color="#B22222">/* Hcurl preserves tangential edge traces  */</font>
<a name="line1396">1396: </a>    <font color="#4169E1">case</font> 2:
<a name="line1397">1397: </a>    trans = COVARIANT_PIOLA_TRANSFORM;<font color="#4169E1">break</font>;
<a name="line1398">1398: </a>    <font color="#4169E1">case</font> 3: <font color="#B22222">/* Hdiv preserve normal traces */</font>
<a name="line1399">1399: </a>    trans = CONTRAVARIANT_PIOLA_TRANSFORM;<font color="#4169E1">break</font>;
<a name="line1400">1400: </a><strong><font color="#FF0000">    default:</font></strong> <a href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) dsp), PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Unsupported simplex dim %D for transformation"</font>, dsp-&gt;k);
<a name="line1401">1401: </a>  }
<a name="line1402">1402: </a>  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceTransform.html#PetscDualSpaceTransform">PetscDualSpaceTransform</a>(dsp, trans, <a href="../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</a>, fegeom, Nq, Nc, pointEval);
<a name="line1403">1403: </a>  <font color="#4169E1">return</font>(0);
<a name="line1404">1404: </a>}

<a name="line1406">1406: </a><font color="#B22222">/*@C</font>
<a name="line1407">1407: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpacePushforward.html#PetscDualSpacePushforward">PetscDualSpacePushforward</a> - Transform the given function so that it operates on real space, rather than the reference element. Operationally, this means that we map the function evaluations depending on continuity requirements of our finite element method.</font>

<a name="line1409">1409: </a><font color="#B22222">  Input Parameters:</font>
<a name="line1410">1410: </a><font color="#B22222">+ dsp        - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>
<a name="line1411">1411: </a><font color="#B22222">. fegeom     - The geometry for this cell</font>
<a name="line1412">1412: </a><font color="#B22222">. Nq         - The number of function samples</font>
<a name="line1413">1413: </a><font color="#B22222">. Nc         - The number of function components</font>
<a name="line1414">1414: </a><font color="#B22222">- pointEval  - The function values</font>

<a name="line1416">1416: </a><font color="#B22222">  Output Parameter:</font>
<a name="line1417">1417: </a><font color="#B22222">. pointEval  - The transformed function values</font>

<a name="line1419">1419: </a><font color="#B22222">  Level: advanced</font>

<a name="line1421">1421: </a><font color="#B22222">  Note: Functionals transform in a complementary way (pullback) to functions, so that the scalar product is invariant. The type of transform is dependent on the associated k-simplex from the DeRahm complex.</font>

<a name="line1423">1423: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpacePullback.html#PetscDualSpacePullback">PetscDualSpacePullback</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceTransform.html#PetscDualSpaceTransform">PetscDualSpaceTransform</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetDeRahm.html#PetscDualSpaceGetDeRahm">PetscDualSpaceGetDeRahm</a>()</font>
<a name="line1424">1424: </a><font color="#B22222">@*/</font>
<a name="line1425">1425: </a><strong><font color="#4169E1"><a name="PetscDualSpacePushforward"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpacePushforward.html#PetscDualSpacePushforward">PetscDualSpacePushforward</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> dsp, PetscFEGeom *fegeom, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nq, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nc, <a href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> pointEval[])</font></strong>
<a name="line1426">1426: </a>{
<a name="line1427">1427: </a>  <a href="../../../../../docs/manualpages/FE/PetscDualSpaceTransformType.html#PetscDualSpaceTransformType">PetscDualSpaceTransformType</a> trans;
<a name="line1428">1428: </a>  <a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a>              ierr;

<a name="line1434">1434: </a>  <font color="#B22222">/* The dualspace dofs correspond to some simplex in the DeRahm complex, which we label by k.</font>
<a name="line1435">1435: </a><font color="#B22222">     This determines their transformation properties. */</font>
<a name="line1436">1436: </a>  <font color="#4169E1">switch</font> (dsp-&gt;k)
<a name="line1437">1437: </a>  {
<a name="line1438">1438: </a>    <font color="#4169E1">case</font> 0: <font color="#B22222">/* H^1 point evaluations */</font>
<a name="line1439">1439: </a>    trans = IDENTITY_TRANSFORM;<font color="#4169E1">break</font>;
<a name="line1440">1440: </a>    <font color="#4169E1">case</font> 1: <font color="#B22222">/* Hcurl preserves tangential edge traces  */</font>
<a name="line1441">1441: </a>    <font color="#4169E1">case</font> 2:
<a name="line1442">1442: </a>    trans = COVARIANT_PIOLA_TRANSFORM;<font color="#4169E1">break</font>;
<a name="line1443">1443: </a>    <font color="#4169E1">case</font> 3: <font color="#B22222">/* Hdiv preserve normal traces */</font>
<a name="line1444">1444: </a>    trans = CONTRAVARIANT_PIOLA_TRANSFORM;<font color="#4169E1">break</font>;
<a name="line1445">1445: </a><strong><font color="#FF0000">    default:</font></strong> <a href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) dsp), PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Unsupported simplex dim %D for transformation"</font>, dsp-&gt;k);
<a name="line1446">1446: </a>  }
<a name="line1447">1447: </a>  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceTransform.html#PetscDualSpaceTransform">PetscDualSpaceTransform</a>(dsp, trans, <a href="../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</a>, fegeom, Nq, Nc, pointEval);
<a name="line1448">1448: </a>  <font color="#4169E1">return</font>(0);
<a name="line1449">1449: </a>}

<a name="line1451">1451: </a><font color="#B22222">/*@C</font>
<a name="line1452">1452: </a><font color="#B22222">  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpacePushforwardGradient.html#PetscDualSpacePushforwardGradient">PetscDualSpacePushforwardGradient</a> - Transform the given function gradient so that it operates on real space, rather than the reference element. Operationally, this means that we map the function evaluations depending on continuity requirements of our finite element method.</font>

<a name="line1454">1454: </a><font color="#B22222">  Input Parameters:</font>
<a name="line1455">1455: </a><font color="#B22222">+ dsp        - The <a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a></font>
<a name="line1456">1456: </a><font color="#B22222">. fegeom     - The geometry for this cell</font>
<a name="line1457">1457: </a><font color="#B22222">. Nq         - The number of function gradient samples</font>
<a name="line1458">1458: </a><font color="#B22222">. Nc         - The number of function components</font>
<a name="line1459">1459: </a><font color="#B22222">- pointEval  - The function gradient values</font>

<a name="line1461">1461: </a><font color="#B22222">  Output Parameter:</font>
<a name="line1462">1462: </a><font color="#B22222">. pointEval  - The transformed function gradient values</font>

<a name="line1464">1464: </a><font color="#B22222">  Level: advanced</font>

<a name="line1466">1466: </a><font color="#B22222">  Note: Functionals transform in a complementary way (pullback) to functions, so that the scalar product is invariant. The type of transform is dependent on the associated k-simplex from the DeRahm complex.</font>

<a name="line1468">1468: </a><font color="#B22222">.seealso: <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpacePushforward.html#PetscDualSpacePushforward">PetscDualSpacePushforward</a>(), PPetscDualSpacePullback(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceTransform.html#PetscDualSpaceTransform">PetscDualSpaceTransform</a>(), <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceGetDeRahm.html#PetscDualSpaceGetDeRahm">PetscDualSpaceGetDeRahm</a>()</font>
<a name="line1469">1469: </a><font color="#B22222">@*/</font>
<a name="line1470">1470: </a><strong><font color="#4169E1"><a name="PetscDualSpacePushforwardGradient"></a><a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpacePushforwardGradient.html#PetscDualSpacePushforwardGradient">PetscDualSpacePushforwardGradient</a>(<a href="../../../../../docs/manualpages/FE/PetscDualSpace.html#PetscDualSpace">PetscDualSpace</a> dsp, PetscFEGeom *fegeom, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nq, <a href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nc, <a href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> pointEval[])</font></strong>
<a name="line1471">1471: </a>{
<a name="line1472">1472: </a>  <a href="../../../../../docs/manualpages/FE/PetscDualSpaceTransformType.html#PetscDualSpaceTransformType">PetscDualSpaceTransformType</a> trans;
<a name="line1473">1473: </a>  <a href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a>              ierr;

<a name="line1479">1479: </a>  <font color="#B22222">/* The dualspace dofs correspond to some simplex in the DeRahm complex, which we label by k.</font>
<a name="line1480">1480: </a><font color="#B22222">     This determines their transformation properties. */</font>
<a name="line1481">1481: </a>  <font color="#4169E1">switch</font> (dsp-&gt;k)
<a name="line1482">1482: </a>  {
<a name="line1483">1483: </a>    <font color="#4169E1">case</font> 0: <font color="#B22222">/* H^1 point evaluations */</font>
<a name="line1484">1484: </a>    trans = IDENTITY_TRANSFORM;<font color="#4169E1">break</font>;
<a name="line1485">1485: </a>    <font color="#4169E1">case</font> 1: <font color="#B22222">/* Hcurl preserves tangential edge traces  */</font>
<a name="line1486">1486: </a>    <font color="#4169E1">case</font> 2:
<a name="line1487">1487: </a>    trans = COVARIANT_PIOLA_TRANSFORM;<font color="#4169E1">break</font>;
<a name="line1488">1488: </a>    <font color="#4169E1">case</font> 3: <font color="#B22222">/* Hdiv preserve normal traces */</font>
<a name="line1489">1489: </a>    trans = CONTRAVARIANT_PIOLA_TRANSFORM;<font color="#4169E1">break</font>;
<a name="line1490">1490: </a><strong><font color="#FF0000">    default:</font></strong> <a href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) dsp), PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Unsupported simplex dim %D for transformation"</font>, dsp-&gt;k);
<a name="line1491">1491: </a>  }
<a name="line1492">1492: </a>  <a href="../../../../../docs/manualpages/DUALSPACE/PetscDualSpaceTransformGradient.html#PetscDualSpaceTransformGradient">PetscDualSpaceTransformGradient</a>(dsp, trans, <a href="../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</a>, fegeom, Nq, Nc, pointEval);
<a name="line1493">1493: </a>  <font color="#4169E1">return</font>(0);
<a name="line1494">1494: </a>}
</pre>
</body>

</html>
