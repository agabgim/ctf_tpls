<HTML>
<HEAD> <link rel="canonical" href="http://www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/Sensitivity/index.html" />
<TITLE>Sensitivity - ODE integrators</TITLE>
</HEAD>
<BODY BGCOLOR="FFFFFF">
   <div id="version" align=right><b>petsc-3.12.4 2020-02-04</b></div>
   <div id="bugreport" align=right><a href="mailto:petsc-maint@mcs.anl.gov?subject=Typo or Error in Documentation &body=Please describe the typo or error in the documentation: petsc-3.12.4 v3.12.4 docs/manualpages/Sensitivity/index.html "><small>Report Typos and Errors</small></a></div>

<H2>Sensitivity analysis for ODE and DAE: <A HREF="../../../src/ts/examples/tutorials/index.html">Examples</A></H2>

The TS library provides discrete adjoint models (TSAdjoint) and tangent linear models (TSForward) for sensitivity analysis for ODEs and DAEs.

The adjoint solvers support gradient calculation for multiple cost functions, and the tangent linear solvers support gradient calculation with respect to multiple parameters. Adjoint is particularly efficient when the number of cost functions is much less than the number of parameters. Note that the parameters can be initial states or system parameters as used in the calculation of ODE/DAE right-hand sides.

Typical cost functions of interest may depend on the final solution to the ODE/DAE or on the whole trajectory (taking an integral form). The integral can be evaluated together with the time integration.

<P>

<P>
<TABLE>
<TR><TD WIDTH=250 COLSPAN="3"><B>Beginner - Basic usage</B></TD></TR>
 <TD WIDTH=250><A HREF="./TSAdjointReset.html">TSAdjointReset</A></TD>
 <TD WIDTH=250><A HREF="./TSSetCostGradients.html">TSSetCostGradients</A></TD>
 <TD WIDTH=250><A HREF="./"></A></TD>
<TR>
 <TD WIDTH=250><A HREF="./TSForwardSetSensitivities.html">TSForwardSetSensitivities</A></TD>
 <TD WIDTH=250><A HREF="./TSSetCostHessianProducts.html">TSSetCostHessianProducts</A></TD>
 <TD WIDTH=250><A HREF="./"></A></TD>
<TR>
<TR><TD WIDTH=250 COLSPAN="3"><B>Intermediate - Setting options for algorithms and data structures</B></TD></TR>
 <TD WIDTH=250><A HREF="./TSAdjointMonitorCancel.html">TSAdjointMonitorCancel</A></TD>
 <TD WIDTH=250><A HREF="./TSAdjointSolve.html">TSAdjointSolve</A></TD>
 <TD WIDTH=250><A HREF="./TSGetQuadratureTS.html">TSGetQuadratureTS</A></TD>
<TR>
 <TD WIDTH=250><A HREF="./TSAdjointMonitorDefault.html">TSAdjointMonitorDefault</A></TD>
 <TD WIDTH=250><A HREF="./TSAdjointStep.html">TSAdjointStep</A></TD>
 <TD WIDTH=250><A HREF="./TSGetRHSJacobianP.html">TSGetRHSJacobianP</A></TD>
<TR>
 <TD WIDTH=250><A HREF="./TSAdjointMonitorDrawSensi.html">TSAdjointMonitorDrawSensi</A></TD>
 <TD WIDTH=250><A HREF="./TSCreateQuadratureTS.html">TSCreateQuadratureTS</A></TD>
 <TD WIDTH=250><A HREF="./TSSetIHessianProduct.html">TSSetIHessianProduct</A></TD>
<TR>
 <TD WIDTH=250><A HREF="./TSAdjointMonitorSensi.html">TSAdjointMonitorSensi</A></TD>
 <TD WIDTH=250><A HREF="./TSForwardGetSensitivities.html">TSForwardGetSensitivities</A></TD>
 <TD WIDTH=250><A HREF="./TSSetIJacobianP.html">TSSetIJacobianP</A></TD>
<TR>
 <TD WIDTH=250><A HREF="./TSAdjointMonitorSet.html">TSAdjointMonitorSet</A></TD>
 <TD WIDTH=250><A HREF="./TSForwardSetInitialSensitivities.html">TSForwardSetInitialSensitivities</A></TD>
 <TD WIDTH=250><A HREF="./TSSetRHSHessianProduct.html">TSSetRHSHessianProduct</A></TD>
<TR>
 <TD WIDTH=250><A HREF="./TSAdjointResetForward.html">TSAdjointResetForward</A></TD>
 <TD WIDTH=250><A HREF="./TSGetCostGradients.html">TSGetCostGradients</A></TD>
 <TD WIDTH=250><A HREF="./TSSetRHSJacobianP.html">TSSetRHSJacobianP</A></TD>
<TR>
 <TD WIDTH=250><A HREF="./TSAdjointSetForward.html">TSAdjointSetForward</A></TD>
 <TD WIDTH=250><A HREF="./TSGetCostHessianProducts.html">TSGetCostHessianProducts</A></TD>
 <TD WIDTH=250><A HREF="./"></A></TD>
<TR>
 <TD WIDTH=250><A HREF="./TSAdjointSetSteps.html">TSAdjointSetSteps</A></TD>
 <TD WIDTH=250><A HREF="./TSGetCostIntegral.html">TSGetCostIntegral</A></TD>
 <TD WIDTH=250><A HREF="./"></A></TD>
<TR>
<TR><TD WIDTH=250 COLSPAN="3"><B>Advanced - Setting more advanced options and customization</B></TD></TR>
 <TD WIDTH=250><A HREF="./TSAdjointCostIntegral.html">TSAdjointCostIntegral</A></TD>
 <TD WIDTH=250><A HREF="./TSForwardGetStages.html">TSForwardGetStages</A></TD>
 <TD WIDTH=250><A HREF="./TSForwardStep.html">TSForwardStep</A></TD>
<TR>
 <TD WIDTH=250><A HREF="./TSAdjointSetUp.html">TSAdjointSetUp</A></TD>
 <TD WIDTH=250><A HREF="./TSForwardReset.html">TSForwardReset</A></TD>
 <TD WIDTH=250><A HREF="./"></A></TD>
<TR>
 <TD WIDTH=250><A HREF="./TSForwardCostIntegral.html">TSForwardCostIntegral</A></TD>
 <TD WIDTH=250><A HREF="./TSForwardSetUp.html">TSForwardSetUp</A></TD>
 <TD WIDTH=250><A HREF="./"></A></TD>
<TR>
<TR><TD WIDTH=250 COLSPAN="3"><B>Developer - Interfaces intended primarily for library developers, not for typical applications programmers</B></TD></TR>
 <TD WIDTH=250><A HREF="./TSAdjointMonitor.html">TSAdjointMonitor</A></TD>
 <TD WIDTH=250><A HREF="./TSComputeIHessianProductFunctionUU.html">TSComputeIHessianProductFunctionUU</A></TD>
 <TD WIDTH=250><A HREF="./TSComputeRHSHessianProductFunctionUU.html">TSComputeRHSHessianProductFunctionUU</A></TD>
<TR>
 <TD WIDTH=250><A HREF="./TSAdjointMonitorSetFromOptions.html">TSAdjointMonitorSetFromOptions</A></TD>
 <TD WIDTH=250><A HREF="./TSComputeIJacobianP.html">TSComputeIJacobianP</A></TD>
 <TD WIDTH=250><A HREF="./TSComputeRHSJacobianP.html">TSComputeRHSJacobianP</A></TD>
<TR>
 <TD WIDTH=250><A HREF="./TSComputeIHessianProductFunctionPP.html">TSComputeIHessianProductFunctionPP</A></TD>
 <TD WIDTH=250><A HREF="./TSComputeRHSHessianProductFunctionPP.html">TSComputeRHSHessianProductFunctionPP</A></TD>
 <TD WIDTH=250><A HREF="./TSComputeSNESJacobian.html">TSComputeSNESJacobian</A></TD>
<TR>
 <TD WIDTH=250><A HREF="./TSComputeIHessianProductFunctionPU.html">TSComputeIHessianProductFunctionPU</A></TD>
 <TD WIDTH=250><A HREF="./TSComputeRHSHessianProductFunctionPU.html">TSComputeRHSHessianProductFunctionPU</A></TD>
 <TD WIDTH=250><A HREF="./"></A></TD>
<TR>
 <TD WIDTH=250><A HREF="./TSComputeIHessianProductFunctionUP.html">TSComputeIHessianProductFunctionUP</A></TD>
 <TD WIDTH=250><A HREF="./TSComputeRHSHessianProductFunctionUP.html">TSComputeRHSHessianProductFunctionUP</A></TD>
 <TD WIDTH=250><A HREF="./"></A></TD>
<TR>
<TR><TD WIDTH=250 COLSPAN="3"><B>Deprecated - Functionality scheduled for removal in future versions</B></TD></TR>
 <TD WIDTH=250><A HREF="./TSAdjointComputeDRDPFunction.html">TSAdjointComputeDRDPFunction</A></TD>
 <TD WIDTH=250><A HREF="./TSComputeCostIntegrand.html">TSComputeCostIntegrand</A></TD>
 <TD WIDTH=250><A HREF="./TSForwardSetIntegralGradients.html">TSForwardSetIntegralGradients</A></TD>
<TR>
 <TD WIDTH=250><A HREF="./TSAdjointComputeDRDYFunction.html">TSAdjointComputeDRDYFunction</A></TD>
 <TD WIDTH=250><A HREF="./TSComputeDRDPFunction.html">TSComputeDRDPFunction</A></TD>
 <TD WIDTH=250><A HREF="./TSSetCostIntegrand.html">TSSetCostIntegrand</A></TD>
<TR>
 <TD WIDTH=250><A HREF="./TSAdjointComputeRHSJacobian.html">TSAdjointComputeRHSJacobian</A></TD>
 <TD WIDTH=250><A HREF="./TSComputeDRDUFunction.html">TSComputeDRDUFunction</A></TD>
 <TD WIDTH=250><A HREF="./"></A></TD>
<TR>
 <TD WIDTH=250><A HREF="./TSAdjointSetRHSJacobian.html">TSAdjointSetRHSJacobian</A></TD>
 <TD WIDTH=250><A HREF="./TSForwardGetIntegralGradients.html">TSForwardGetIntegralGradients</A></TD>
 <TD WIDTH=250><A HREF="./"></A></TD>
<TR>
</TABLE>
<BR><A HREF="../../index.html">Table of Contents</A>
