<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML3.2 EN">
<HTML>
<HEAD> <link rel="canonical" href="http://www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/TS/TSSetSolutionFunction.html" />
<META NAME="GENERATOR" CONTENT="DOCTEXT">
<TITLE>TSSetSolutionFunction</TITLE>
</HEAD>
<BODY BGCOLOR="FFFFFF">
   <div id="version" align=right><b>petsc-3.12.4 2020-02-04</b></div>
   <div id="bugreport" align=right><a href="mailto:petsc-maint@mcs.anl.gov?subject=Typo or Error in Documentation &body=Please describe the typo or error in the documentation: petsc-3.12.4 v3.12.4 docs/manualpages/TS/TSSetSolutionFunction.html "><small>Report Typos and Errors</small></a></div>
<A NAME="TSSetSolutionFunction"><H1>TSSetSolutionFunction</H1></A>
Provide a function that computes the solution of the ODE or DAE 
<H3><FONT COLOR="#CC3333">Synopsis</FONT></H3>
<PRE>
#include "petscts.h"  
<A HREF="../Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A HREF="../TS/TSSetSolutionFunction.html#TSSetSolutionFunction">TSSetSolutionFunction</A>(<A HREF="../TS/TS.html#TS">TS</A> ts,<A HREF="../Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> (*f)(<A HREF="../TS/TS.html#TS">TS</A>,<A HREF="../Sys/PetscReal.html#PetscReal">PetscReal</A>,<A HREF="../Vec/Vec.html#Vec">Vec</A>,void*),void *ctx)
</PRE>
Logically Collective on <A HREF="../TS/TS.html#TS">TS</A>
<P>
<H3><FONT COLOR="#CC3333">Input Parameters</FONT></H3>
<TABLE border="0" cellpadding="0" cellspacing="0">
<TR><TD WIDTH=40></TD><TD ALIGN=LEFT VALIGN=TOP><B>ts </B></TD><TD>- the <A HREF="../TS/TS.html#TS">TS</A> context obtained from <A HREF="../TS/TSCreate.html#TSCreate">TSCreate</A>()
</TD></TR>
<TR><TD WIDTH=40></TD><TD ALIGN=LEFT VALIGN=TOP><B>f </B></TD><TD>- routine for evaluating the solution
</TD></TR>
<TR><TD WIDTH=40></TD><TD ALIGN=LEFT VALIGN=TOP><B>ctx </B></TD><TD>- [optional] user-defined context for private data for the
function evaluation routine (may be NULL)
</TD></TR></TABLE>
<P>
<H3><FONT COLOR="#CC3333">Calling sequence of func</FONT></H3>
<pre>
    <A HREF="../Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> func (<A HREF="../TS/TS.html#TS">TS</A> ts,<A HREF="../Sys/PetscReal.html#PetscReal">PetscReal</A> t,<A HREF="../Vec/Vec.html#Vec">Vec</A> u,void *ctx);
</pre>
<P>
<TABLE border="0" cellpadding="0" cellspacing="0">
<TR><TD WIDTH=40></TD><TD ALIGN=LEFT VALIGN=TOP><B>t </B></TD><TD>- current timestep
</TD></TR>
<TR><TD WIDTH=40></TD><TD ALIGN=LEFT VALIGN=TOP><B>u </B></TD><TD>- output vector
</TD></TR>
<TR><TD WIDTH=40></TD><TD ALIGN=LEFT VALIGN=TOP><B>ctx </B></TD><TD>- [optional] user-defined function context
</TD></TR></TABLE>
<P>
<H3><FONT COLOR="#CC3333">Options Database</FONT></H3>
<TABLE border="0" cellpadding="0" cellspacing="0">
<TR><TD WIDTH=40></TD><TD ALIGN=LEFT VALIGN=TOP><B>-ts_monitor_lg_error </B></TD><TD>- create a graphical monitor of error history, requires user to have provided <A HREF="../TS/TSSetSolutionFunction.html#TSSetSolutionFunction">TSSetSolutionFunction</A>()
</TD></TR>
<TR><TD WIDTH=40></TD><TD ALIGN=LEFT VALIGN=TOP><B>-ts_monitor_draw_error </B></TD><TD>- Monitor error graphically, requires user to have provided <A HREF="../TS/TSSetSolutionFunction.html#TSSetSolutionFunction">TSSetSolutionFunction</A>()
</TD></TR></TABLE>
<P>
<H3><FONT COLOR="#CC3333">Notes</FONT></H3>
This routine is used for testing accuracy of time integration schemes when you already know the solution.
If analytic solutions are not known for your system, consider using the Method of Manufactured Solutions to
create closed-form solutions with non-physical forcing terms.
<P>
For low-dimensional problems solved in serial, such as small discrete systems, <A HREF="../TS/TSMonitorLGError.html#TSMonitorLGError">TSMonitorLGError</A>() can be used to monitor the error history.
<P>

<P>
<H3><FONT COLOR="#CC3333">See Also</FONT></H3>
 <A HREF="../TS/TSSetRHSJacobian.html#TSSetRHSJacobian">TSSetRHSJacobian</A>(), <A HREF="../TS/TSSetIJacobian.html#TSSetIJacobian">TSSetIJacobian</A>(), <A HREF="../TS/TSComputeSolutionFunction.html#TSComputeSolutionFunction">TSComputeSolutionFunction</A>(), <A HREF="../TS/TSSetForcingFunction.html#TSSetForcingFunction">TSSetForcingFunction</A>(), <A HREF="../TS/TSSetSolution.html#TSSetSolution">TSSetSolution</A>(), <A HREF="../TS/TSGetSolution.html#TSGetSolution">TSGetSolution</A>(), <A HREF="../TS/TSMonitorLGError.html#TSMonitorLGError">TSMonitorLGError</A>(), <A HREF="../TS/TSMonitorDrawError.html#TSMonitorDrawError">TSMonitorDrawError</A>()
<BR><P><B></B><H3><FONT COLOR="#CC3333">Level</FONT></H3>beginner<BR>
<H3><FONT COLOR="#CC3333">Location</FONT></H3>
</B><A HREF="../../../src/ts/interface/ts.c.html#TSSetSolutionFunction">src/ts/interface/ts.c</A>
<P><H3><FONT COLOR="#CC3333">Examples</FONT></H3>
<A HREF="../../../src/ts/examples/tutorials/ex50.c.html">src/ts/examples/tutorials/ex50.c.html</A><BR>
<A HREF="../../../src/tao/unconstrained/examples/tutorials/spectraladjointassimilation.c.html">src/tao/unconstrained/examples/tutorials/spectraladjointassimilation.c.html</A><BR>
<BR><A HREF="./index.html">Index of all TS routines</A>
<BR><A HREF="../../index.html">Table of Contents for all manual pages</A>
<BR><A HREF="../singleindex.html">Index of all manual pages</A>
</BODY></HTML>
